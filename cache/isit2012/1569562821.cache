{"id":"1569562821","paper":{"title":{"text":"Achieving the Shannon Limit with Probabilistically Shaped BICM"},"authors":[{"name":"Erik Agrell"},{"name":"Alex Alvarado"}],"abstr":{"text":"Abstract\u2014Probabilistic shaping for bit-interleaved coded mod- ulation (BICM) systems at low signal-to-noise ratio (SNR) is investigated. Using known results for BICM systems with a uniform input distribution, the combinations of input alphabet, input distribution, and binary labeling that achieve the Shannon limit \u20131.59 dB are fully characterized. It is found that a BICM system achieves the Shannon limit at low SNR if and only if it can be represented as a zero-mean linear projection of a hypercube, which is the same condition as for uniform input distributions. Hence, probabilistic shaping offers no extra degrees of freedom to optimize the low-SNR regime of BICM systems, in addition to what is provided by geometrical shaping."},"body":{"text":"The most important breakthrough for coded modulation (CM) in fading channels came in 1992, when Zehavi intro- duced the so-called bit-interleaved coded modulation (BICM) in [1], usually referred to as a pragmatic approach for CM [2], [3]. Despite not being fully understood theoretically, BICM has been rapidly adopted in commercial systems such as wireless and wired broadband access networks, 3G/4G telephony, and digital video broadcasting, making it as the de facto standard for current telecommunications systems.\nSignal shaping [4], [5] refers to the use of non-equally spaced and/or non-equally likely symbols, i.e., geometrical shaping and probabilistic shaping. In the context of BICM, geometrical shaping for BICM was proposed in [6]\u2013[8] and probabilistic shaping in [9].\nFor the additive white Gaussian noise (AWGN) channel, the Shannon Limit (SL) −1.59 dB represents the average bit energy to noise-ratio needed to transmit information reliably when the signal-to-noise ratio (SNR) tends to zero [10], [11]. The SL is fully determined by the ﬁrst derivative of the mutual information (MI) function at zero SNR [10, Sec I] [11, eq. (1)].\nWhen discrete alphabets are used with a BICM receiver, the SL is not always achieved [12]. This was shown in [13] to be caused by the selection of the binary labeling. The performance of BICM at low SNR, i.e., in the wideband regime, was studied in [12]\u2013[14]. In [15], the wideband\nbehavior was shown to be determined by three transmission parameters: the input alphabet X, its input distribution P, and its binary labeling L. First-order optimal (FOO) constellations were deﬁned as the triplet [X, P, L] that make a BICM system achieve the SL. The optimality analysis in [15], however, only considers uniform input distributions. Probabilistic shaping for BICM was considered in [9], [16]\u2013[18]. Recently, the ﬁrst-order equivalence between some uniform and nonuniform constellations for BICM was numerically studied in [19].\nThe main contribution of this paper is to generalize the results of [15] to nonuniform input distributions using the equivalence in [19]. A complete characterization of FOO constellations for BICM in terms of [X, P, L] is obtained. In particular, we ﬁnd the geometrical and/or probabilistic shaping rules that should be applied to a constellation to make it FOO. We conclude that for BICM systems in the wideband regime, probabilistic shaping offers no extra degrees of freedom in addition to what is provided by geometrical shaping.\nThroughout this paper all MIs are given in bits. Vectors are row vectors x and matrices are denoted by X. The inner product between two vectors a and b is denoted by a, b . The Euclidean norm of the vector a is denoted by a . Random variables are denoted by capital letters X and random vectors by boldface capital letters X. The probability density function (pdf) of the random vector Y is denoted by p Y (y) and the conditional pdf by p Y |X (y|x). A similar notation applies to probability mass functions (pmf) of a random variable, which we denote by P Y (y) and P Y |X (y|x). Expectations are denoted by E. The binary set is deﬁned as B {0, 1}. The negation of a bit b is denoted by ¯b = 1 − b.\nWe consider transmissions over a discrete-time memoryless AWGN channel. The received vector at any discrete time instant is Y = X + Z, where X is the real-valued channel input and Z is a real Gaussian noise with zero mean and variance N 0 /2 in each dimension. The conditional transition\nThe SNR is deﬁned as snr E s /N 0 = R c E b /N 0 , where E s E X [ X 2 ] is the average symbol energy, R c is the transmission rate in information bits per symbol, and E b is the average energy per information bit.\nWe consider the generic BICM scheme in Fig. 1. In the sim- plest case, a binary encoder is concatenated with a memoryless modulator Φ via a bit-level interleaver. Multiple encoders and/or interleavers may be used to obtain probabilistic shaping. At the receiver, using the channel output Y , the demapper Φ −1 computes metrics L k for the individual coded bits C k with k = 0, . . . , m−1, usually in the form of logarithmic likelihood ratios. These metrics are then passed to the deinterleaver(s) and decoder(s) to obtain an estimate of the information bits.\nThe mapper Φ is deﬁned via the input alphabet X = [x T 0 , . . . , x T M−1 ] T ∈ R M×N , where m bits are used to index the symbols vectors x i ∈ R N for i = 0, . . . , M − 1, M = 2 m . We associate with each symbol x i a binary m-tuple (codeword) c i [c i,0 , . . . , c i,m−1 ] ∈ B m and the probability 0 ≤ P i ≤ 1, where P i P X (x i ). The binary labeling is denoted by L = [c T 0 , . . . , c T M−1 ] T ∈ B M×m and the input distribution by P = [P 0 , . . . , P M−1 ] T ∈ [0, 1] M .\nFor any constellation [X, P, L], a set of equivalent constel- lations can be constructed by simultaneously permuting the rows of X, L, and P. Speciﬁcally, it is possible to permute the rows of any labeling matrix L such that any other labeling is obtained. Without loss of generality, we therefore ﬁx the labeling to be the natural binary code (NBC) from now on, deﬁned as follows.\nDeﬁnition 1 (Natural binary code): The NBC is the binary labeling N m [n(0) T , . . . , n(M − 1) T ] T , where n(i) = [n i,0 , . . . , n i,m−1 ] ∈ B m denotes the base-2 representation of the integer 0 ≤ i ≤ M − 1, with n i,m−1 being the most signiﬁcant bit.\nBased on the previous discussion, from now on we use the name constellation to denote the pair [X, P], where the NBC labeling is implicit. Assuming independent, but possibly nonuniformly distributed, bits C 0 , . . . , C m−1 at the input of the modulator, the symbol probabilities are given by [15, eq. (30)] [9, eq. (8)]\nfor i = 0, . . . , M − 1 and for some [P C 0 (0), . . . , P C m−1 (0)]. Since P C k (1) = 1−P C k (0), the distribution P is fully speciﬁed by the set of bit probabilities [P C 0 (0), . . . , P C m−1 (0)]. An important special case is the uniform distribution, for which P C k (0) = 1/2 for k = 0, . . . , m − 1 and P = U m\nThroughout this paper, we assume that 0 < P C k (0) < 1 for all k = 0, . . . , m − 1, i.e., we assume that all constellation points are used with a nonzero probability. If that was not the case, the cardinality of the constellation should be reduced. Hence P i > 0 for i = 0, . . . , M − 1.\nThe Hadamard transform (HT), or Walsh\u2013Hadamard trans- form, is a discrete, linear, orthogonal transform, whose coef- ﬁcients take values in ±1. It is deﬁned as follows.\nDeﬁnition 2: The HT ˜ X = [˜ x T 0 , . . . , ˜ x T M−1 ] T of a matrix (or vector) X = [x T 0 , . . . , x T M−1 ] T with M = 2 m rows is\nBecause n 0 ,k = 0 for k = 0, . . . , m − 1, setting i = 0 in (3)\u2013(4) shows that the ﬁrst HT vector\ncan be interpreted as the uniformly weighted mean of the alphabet. This is a property that the HT shares with, e.g., the discrete Fourier transform.\nThe inverse transform is identical to the forward transform, apart from a scale factor:\nThe mutual information (MI) in bits per channel use be- tween the random vectors X and Y is deﬁned as\nwhere the expectation is taken over the joint pdf p X ,Y (x, y), and p Y |X (y|x) is given by (1).\nThe conditional MI is deﬁned as the MI between X and Y conditioned on the value of the kth bit at the input of the modulator, i.e.,\n(Y |u) \t , (8) where the expectation is taken over the conditional joint pdf p X ,Y |C k (x, y|u).\nDeﬁnition 3 (BICM Generalized MI): The BICM General- ized Mutual Information (BICM-GMI) is deﬁned as [2], [12], [13], [20], [21]\n(9) Martinez et al. [21] recognized the BICM decoder in Fig. 1\nas a mismatched decoder and showed that the BICM-GMI in (9) corresponds to an achievable rate of such a decoder. This means that reliable transmission using a BICM system at rate R c is possible if R c < I (snr).\nDeﬁnition 4 (Low-SNR parameters): The low-SNR param- eters of a constellation [X, P] are deﬁned as [µ, E s , α], where\nIt can be shown that for asymptotically low SNR, i.e., in the wideband regime, the average received bit energy needed for reliable transmission is lower-bounded by E b /N 0 ≥ 1/α ≥ log e 2, where the bound log e 2 corresponds to the SL −1.59 dB.\nThe low-SNR parameters [µ, E s , α] have been analyzed in detail for arbitrary input alphabets X under the assumption of uniform probabilities [15]. Under this assumption, they can be expressed as functions of the HT of the alphabet ˜ X as shown in the following theorem.\nTheorem 1: For a constellation [X, U m ], the low-SNR pa- rameters are\n(12) Proof: The expressions in (10) are obtained from Deﬁni-\ntion 4 and (5), the ones in (11) from from Deﬁnition 4 and [15, eq. (16)], and the ones in (12) from [15, eq. (50)] and [15, Theorem 11].\nTheorem 1 can be generalized to arbitrary constellations [X, P] as follows.\nTheorem 2: For a constellation [X, P], the low-SNR param- eters are\nProof: Expressions (13) and (14) follow from Deﬁnition 4, while (15) can be obtained using [15, Theorem 10] plus some algebra. For a detailed proof, we refer the reader to [22, Theorem 6].\nTheorem 2 shows that the low-SNR parameters depend on the input alphabet X, the binary labeling (via n i,k in the expression for α), and the input distribution (via P C k (u) and P i ).\nHaving characterized the low-SNR behavior of the BICM- GMI of an arbitrary constellation, the next step is to search for optimal constellations in terms of the BICM-GMI at low SNR. The following deﬁnition formally deﬁnes BICM systems that achieve the SL.\nDeﬁnition 5 (FOO constellation): The constellation [X, P] is said to be ﬁrst-order optimal (FOO) if a BICM system using [X, P] achieves the SL −1.59 dB, i.e., α = log 2 e.\nIn what follows, we derive necessary and sufﬁcient condi- tions for a BICM system, with an arbitrary input alphabet and probability distribution, to achieve the SL. The proofs for the next two theorems, which are omitted due to space limitations, rely on a linear transform introduced in [19]. We refer the reader to [22] for them.\nTheorem 3 ([22, Theorem 9]): The constellation [X, P] is FOO if and only if the HT ˜ X of X satisﬁes both the following conditions:\n˜ x j = 0, \t ∀j / ∈ {0} ∪ {1, 2, 4, . . . , M/2}. (17) Note that only (16) depends on the input distribution, not\n(17). In view of [15, Theorem 12], the only difference between FOO constellations with uniform and nonuniform distributions lie in ˜ x 0 . The ﬁnal theorem gives this statement a more intuitive interpretation.\nTheorem 4 ([22, Theorem 10]): The constellation [X, P] is FOO if and only if both the following conditions hold:\nµ = 0 \t (18) ˜ x j = 0, \t ∀j / ∈ {0} ∪ {1, 2, 4, . . . , M/2}. (19)\nBased on [15, Theorem 12], the result in Theorem 4 can be understood as follows. If a constellation with a uniform input distribution is FOO, it will still be FOO for any other input distribution P C 0 (0), . . . , P C m−1 (0) provided that the input alphabet is translated to be zero mean. The result in Theorem 4 also states that a constellation is FOO if and only if its input alphabet is a linear projection of a hypercube and it has zero mean. This behavior is illustrated in Example 1 and also in [15, Fig. 4].\nWe also note that the zero-mean condition in Theorem 4 is the same that guarantees FOO for the coded modulation MI (CM-MI) [15, Footnote 12] 1 . This implies that the only difference between FOO constellations for the CM-MI and the BICM-GMI lies on the extra constraint on the input alphabet to be a linear projection of a hypercube.\nIn this section we give numerical examples to illustrate the analytical results presented in this paper.\nExample 1: Consider the alphabet shown in [15, Fig. 4 (a)], here called OTTO (one-three-three-one), which corresponds to a projected hypercube. This alphabet is\n−1 1 −3 −1 1 3 −1 1 0 −2 0 −2 2 0 2 0\nThe constellation [X OTTO , U 3 ] was shown to be FOO in [15, Example 4].\nIn this example, we are interested in the ﬁrst-order behavior of the constellation [X OTTO , P] for different P. In view of Theorem 4, this constellation will be FOO if it has zero mean. Using (20) and (2) in (13), we ﬁnd (after some algebra) that\nFor certain distributions, the mean (21) is zero. Speciﬁcally, µ = 0 if and only if\nClearly, the uniform case (P C 0 (0) = P C 1 (0) = P C 2 (0) = 1/2) analyzed in [15] fulﬁlls (22). When any other set of bit probabilities fulﬁlling (22) is used, the resulting con- stellation will be FOO. This is the case for instance if [P C 0 (0), P C 1 (0), P C 2 (0)] = [0.3, 0.1, 0.3] which induces via (2) an input distribution denoted by P 1 . The obtained con- stellation [X OTTO , P 1 ] is illustrated in Fig. 2 with ﬁlled circles, where the area of the circles is proportional to the corresponding symbol probabilities.\nInput distributions do not generally fulﬁll (22). For ex- ample, the set of probabilities [P C 0 (0), P C 1 (0), P C 2 (0)] = [0.2, 0.3, 0.8] gives an input distribution P 2 for which the mean (21) is µ = [−0.4, −1.2]. We deﬁne a new alphabet X OTTO by subtracting µ from each element in X OTTO . The translated constellation [X OTTO , P 2 ], shown in Fig. 2, is a zero-mean projected hypercube and thus FOO according to Theorem 4.\nIn Fig. 3, we show the BICM-GMI for the zero-mean constellations [X OTTO , P 1 ] and [X OTTO , P 2 ] in Fig. 2 as well as for the constellation [X OTTO , U 3 ] in [15, Fig. 4 (a)]. As expected, all the MI curves converge at the SL for low SNR.\nThe exempliﬁed method holds in full generality: Any alpha- bet that is FOO with a uniform input distribution is FOO also with an arbitrary nonuniform distribution, if it is translated to zero mean. Furthermore, all nonuniform FOO constellations can be constructed in this manner.\nExample 2: M -ary pulse amplitude modulation (PAM) al- phabets have been shown to be FOO if the NBC is used with a uniform input distribution, i.e, the constellation [X PAM , U m ] with X PAM = [−(M − 1), −(M − 3), . . . , M − 1] is FOO\n[13] [15, Theorem 14]. In this example, we study the ﬁrst- order behavior of the Gray-labeled 8-PAM alphabet X PAM = [−7, 7, −1, 1, −5, 5, −3, 3]. The constellation [X PAM , P] is known not to be FOO for U 3 [12, Theorem 3].\nThe BICM-GMI of X PAM is shown in Fig. 4 for the set of bit probabilities [P C 0 (0), P C 1 (0), P C 2 (0)] = [0.5, p, p] for different values of p. For p = 0.5, the uniform distribution is obtained. As p decreases, the Gray-coded constellation approaches a zero-mean binary alphabet, which is FOO [9, Fig. 2] [15, Fig. 3(b)]. The results in Fig. 4 show the tradeoff between the low- and high-SNR regimes: The SL can be approached by decreasing p, but this causes a decrease in MI in the high-SNR regime. Alternatively, the SL can be attained by switching from the Gray code to the NBC, but this also comes with a heavy penalty at higher SNRs.\nWe have characterized BICM systems that attain the SL −1.59 dB at asymptotically low SNR, i.e., FOO constellations. Somewhat disappointingly, the set of probabilistically shaped FOO constellation is no larger than the set of FOO constel- lations with uniform distributions, disregarding translations of\nthe whole input alphabet. Both sets can be fully characterized as the set of linear projections of a hypercube, translated to have zero mean for the considered input distribution. It is impossible to make non-FOO constellations for BICM FOO by probabilistic shaping, except in degenerate cases (by setting some probabilities equal to zero)."},"refs":[{"authors":[{"name":"E. Zehavi"}],"title":{"text":"8-PSK trellis codes for a Rayleigh channel"}},{"authors":[{"name":"G. Caire"},{"name":"G. Taricco"},{"name":"E. Biglieri"}],"title":{"text":"Bit-interleaved coded modula- tion"}},{"authors":[{"name":"A. Guill´en i F`abregas"},{"name":"A. Martinez"},{"name":"G. Caire"}],"title":{"text":"Bit-interleaved coded modulation"}},{"authors":[{"name":"A. R. Calderbank"},{"name":"L. H. Ozarow"}],"title":{"text":"Nonequiprobable signaling on the Gaussian channel"}},{"authors":[{"name":"R. F. H. Fische"}],"title":{"text":"Precoding and Signal Shaping for Digital Transmission"}},{"authors":[{"name":"D. Sommer"},{"name":"G. P. Fettweis"}],"title":{"text":"Signal shaping by non-uniform QAM for AWGN channels and applications using turbo coding"}},{"authors":[{"name":"S. Y. Le Goff"}],"title":{"text":"Signal constellations for bit-interleaved coded modula- tion"}},{"authors":[{"name":"M. Barsoum"},{"name":"C. Jones"},{"name":"M. Fitz"}],"title":{"text":"Constellation design via capacity maximization"}},{"authors":[{"name":"A. Guill´en i F`abregas"},{"name":"A. Martinez"}],"title":{"text":"Bit-interleaved coded mod- ulation with shaping"}},{"authors":[{"name":"S. Verd´u"}],"title":{"text":"Spectral efﬁciency in the wideband regime"}},{"authors":[{"name":"V. V. Prelov"},{"name":"S. Verd´u"}],"title":{"text":"Second-order asymptotics of mutual infor- mation"}},{"authors":[{"name":"A. Martinez"},{"name":"A. Guill´en i F`abregas"},{"name":"G. Caire"}],"title":{"text":"Bit-interleaved coded modulation in the wideband regime"}},{"authors":[{"name":"C. Stierstorfer"},{"name":"R. F. H. Fischer"}],"title":{"text":"Asymptotically optimal mappings for BICM with M -PAM and M 2 -QAM"}},{"authors":[],"title":{"text":"Mappings for BICM in UWB scenarios"}},{"authors":[{"name":"E. Agrell"},{"name":"A. Alvarado"}],"title":{"text":"Optimal alphabets and binary labelings for BICM at low SNR"}},{"authors":[{"name":"D. Raphaeli"},{"name":"A. Gurevitz"}],"title":{"text":"Constellation shaping for pragmatic turbo-coded modulation with high spectral efﬁciency"}},{"authors":[{"name":"S. Y. Le Goff"},{"name":"B. S. Sharif"},{"name":"S. A. Jimaa"}],"title":{"text":"Bit-interleaved turbo- coded modulation using shaping coding"}},{"authors":[{"name":"S. Y. Le Goff"},{"name":"B. K. Khoo"},{"name":"C. C. Tsimenidis"},{"name":"B. S. Sharif"}],"title":{"text":"Constellation shaping for bandwidth-efﬁcient turbo-coded modulation with iterative receiver"}},{"authors":[{"name":"E. Agrell"},{"name":"A. Alvarado"}],"title":{"text":"First-order asymptotics of the BICM mutual information: Uniform vs. nonuniform distributions"}},{"authors":[{"name":"T. T. Nguyen"},{"name":"L. Lampe"}],"title":{"text":"Bit-interleaved coded modulation with mismatched decoding metrics"}},{"authors":[{"name":"A. Martinez"},{"name":"A. Guill´en i F`abregas"},{"name":"G. Caire"}],"title":{"text":"Bit-interleaved coded modulation revisited: A mismatched decoding perspective"}},{"authors":[{"name":"E. Agrell"},{"name":"A. Alvarado"}],"title":{"text":"Signal shaping for BICM at low SNR"}}]},"file":{"jsonClass":"File","file":"/home/arnfred/Code/trailhead/resources/isit2012/1569562821.pdf"},"links":[],"meta":{"jsonClass":"HashMap$HashTrieMap","sessionid":"S13.T8.5","endtime":"16:20","authors":"Erik Agrell, Alex Alvarado","date":"1341504000000","papertitle":"Achieving the Shannon Limit with Probabilistically Shaped BICM","starttime":"16:00","session":"S13.T8: Coded Modulation","room":"Stratton (491)","paperid":"1569562821"},"cluster":{"jsonClass":"Map$EmptyMap$"}}
