{"id":"1569566429","paper":{"title":{"text":"Cryptanalysis of a Homomorphic Encryption Scheme From ISIT 2008"},"authors":[{"name":"Jingguo Bi"},{"name":"Mingjie Liu"},{"name":"Xiaoyun Wang"}],"abstr":{"text":"Abstract\u2014At ISIT 2008, Aguilar Melchor, Castagnos and Ga- borit presented a lattice-based homomorphic encryption scheme (abbreviated as MCG). Its security is based on the Computational Knapsack Vector Problem. In this paper, we explore a secret linear relationship between the public keys and the secret keys, which can be used to construct a reduced-dimension lattice, and then we obtain a group of equivalent private keys by solving the Closest Vector Problem of the lattice. Moreover, our attack is practical on all the three settings of recommended parameters, and the running time to recover the equivalent private keys is only several hours on a single PC.\nKey words: Lattice-based, Homomorphic encryption, Key- recovery attack"},"body":{"text":"Homomorphic encryption is an interesting concept to pro- tect privacy, which was proposed by Rivest, Adleman and Der- touzos [26] in 1978. Since its publication, several homomor- phic encryptions have been designed for the e-voting system [5], [24], [9], private information retrieval protocol [19], [21] and so on. Nowadays, cloud computing has become trendy in computer science. One obstruction to cloud computing is the loss of privacy and sensitive data. Homomorphic encryption schemes can partially solve this problem.\nFormally, a homomorphic encryption scheme can be de- scribed as follows: for two messages m 1 , m 2 , it satisﬁes that Dec(En(a) ⊗ En(b)) = a ⊕ b, where ⊗ and ⊕ are two operations over ciphertexts and plaintexts, respectively. Usu- ally, if ⊕ represents modular addition over plaintexts, we call the scheme additively-homomorphic. After the introduction of privacy homomorphism, many schemes have been proposed, such as additive homomorphic encryption schemes [16], [1], [23], [30], [24], [9], [15], [18], [20], [25] and multiplicative homomorphic encryption schemes [10]. At TCC\u201905, Boneh et. al. [4] ﬁrstly constructed an encryption scheme permitting both operations at the same time - this scheme handles an arbitrary number of additions and just one multiplication. More recently, Gentry proposed a fully homomorphic cryptosystem based on ideal lattice which allows arbitrary times additions and multiplications on encrypted data [11], [12], [13]. After\nthat, further research focused on how to fast implement the existing fully homomorphic schemes [29], [14], and how to construct new homomorphic encryption schemes based on other hard problems, such as approximate greatest common divisor problems [8], [6] and Ring-LWE [2], [3]. As to the cryptanalysis of homomorphic encryptions, Chen and Nguyen [7] presented a square-root attack to break the challenges announced in [6] successfully.\nThe MCG cryptosystem is a lattice-based encryption scheme with bounded homomorphic property. This scheme operates over vector spaces of Z p , the encryption and decryp- tion speeds are faster than the previous homomorphic schemes. The one-wayness of the MCG scheme relies on the hardness of the Computational Knapsack Vector Problem (CKVP). For the settings of recommended parameters, the known method to recover the message is to ﬁnd a short vector in a lattice with dimension of at least 600. In this paper, we present a key-recovery attack on MCG by avoiding the CKVP directly. Firstly, we uncover a hidden linear relationship between the public keys and the private keys, then construct a reduced- dimension lattice from partial public keys. Finally, we compute the equivalent secret keys by solving the Closest Vector Problem (CVP) of the new lattice. Our attack is more efﬁcient than solving the CKVP. According to our experiments, all the three scheme instances with the recommended parameters are broken practically.\nWe organize the paper as follows. In Section 2, we recall some backgrounds about lattices. Section 3 describes the MCG lattice-based homomorphic encryption scheme. In Section 4, we show how to attack the scheme. In section 5, experimental results of our attack are provided. We conclude this paper in Section 6 .\nLet R m be the m-dimensional Euclidean space. A lattice in R m is a discrete group L(b 1 , . . . , b n ) = { n i=1 x i b i : x i ∈ Z} of all integral combinations of n linearly independent vectors b 1 , . . . , b n ∈ R m . The integer n is called the rank of\nthe lattice L. The sequence of vectors (b 1 , . . . , b n ) is called a lattice basis, and it is conveniently represented as a matrix\nwhere the columns represent the base vectors. The determinant of the lattice L is deﬁned as det(L(B)) = det(B T B).\nThe most famous computational hard problems on lattices are SVP (Shortest Vector Problem) and CVP (Closest Vector Problem).\nDeﬁnition 1. (SVP) Given a basis of a lattice L, ﬁnd a non- zero vector u ∈ L, such that u ≤ v for any vector v ∈ L \\ 0.\nDeﬁnition 2. (CVP) Given a basis B of a lattice L and a target vector t / ∈ L, ﬁnd a vector u ∈ L such that\nDeﬁnition 3. (Successive minima) Given a lattice L with rank n, the i-th minima λ i (L) is the radius of the smallest sphere centered in the origin containing i linearly independent lattice vectors, i.e.,\nwhere B n (r) represents the n-dimension ball centered at the origin with radius r.\nDeﬁne the λ 2 -gap as λ 2 /λ 1 . Intuitively, as the gap becomes larger, the basis reduction algorithm will work better.\nThe notation M n (Z p ) denotes the n × n matrices over Z p , and GL n (Z p ) represents the invertible matrices of M n (Z p ). All the operations between matrix are over Z p . For simplicity, we omit this in the rest of our paper.\nThe MCG scheme has ﬁve global parameters. Let N be the number of coordinates of the plaintext vectors, and m 0 represents the characteristic of the ring over which they are constructed. The symbol l denotes the maximum number of homomorphic operations that can be done, n represents the number of noisy matrices in the public key, and r 0 is the upper bound for the coordinates of the random disturbing vectors used in the encryption.\n1) Let s 0 = n × N × r 0 + (N − 1) × m 0 , set q = 2 × s 0 × (2l + 1), and select a prime p such that p = q × r + s with s < s 0 .\n2) Choose two random matrices M 1 from GL N (Z p ) and M 2 from M N (Z p ). Denote M = [M 1 |M 2 ].\n3) For each i ∈ {0, 1, · · · , n}, generate a random matrix P i ∈ GL N (Z p ), compute the matrix B i = [B i1 |B i2 ] = [P i M 1 |P i M 2 ].\n4) For each i ∈ {0, 1, · · · , n}, generate a random N × N noise matrix ε i over {−1, 1}. For the matrix ε 0 , multiply each diagonal term by q.\n5) Generate the random scrambling matrix ∆ from GL 2N (Z p ).\nThe public key consists of matrices B 0 , · · · , B n . The private keys are the hidden matrix M and the scrambling matrix ∆. Encryption:\nChoose a message vector m in Z N m 0 and select n random dis- turbing vectors r i with coordinates in [−r 0 , −r 0 /2]∪[r 0 /2, r 0 ]. Input: a message m ∈ Z N m 0 .\n1) For each i ∈ {1, · · · , n}, randomly construct the dis- turbing vectors r i in Z N r 0 .\n2) Compute c = mB 0 + n i=1 r i B i . Output: the ciphertext c ∈ (Z/pZ) 2N . Decryption:\n2) Retrieve the noise e = c D − c U M −1 1 M 2 , where c U and c D are the undisturbed and disturbed halves of c respectively.\n3) For each e i in e = [e 1 , · · · , e N ], compute e i = e i − µ with µ = e i mod q if (e i mod q) < q/2, and µ = (e i mod q) − q, otherwise.\n5) Return m = (m 1 , · · · , m N ). Output: the plaintext m.\nDeﬁnition 4. (Computational Knapsack Vector Problem) Let p be a large prime number. Let e and r be two integers with e < r < p . Consider a set of n + 1 different matrices B 0 , B 1 , · · · , B n of size N × 2N . Let c be an element of the subset\nClearly, this problem is a generalization of the knapsack problem. Breaking the one-wayness of the MCG scheme can be reduced to an instance of CKVP with r = m 0 and e = r 0 . To solve this instance of CKVP, the designers suggested the following lattice spanned by the columns of (n + 3)N × ((n + 3)N + 1) matrix\nx = (m 1 , · · · , m N , r 11 , · · · , r 1N , · · · , r n1 , · · · , r nN , 0, · · · , 0) T is a short vector in lattice L HLP . The recommended param- eters are n = 9 and N = 50, which ensure the dimension of lattice L HLP up to 600 to resist against the lattice attack. In this paper, we skip the CKVP and propose a key-recovery attack for this scheme.\nIn this section, we describe the details of our attack on MCG scheme. Firstly, we show that, there is a hidden linear relation- ship between the public keys and private keys. Secondly, we construct a reduced-dimension lattice from the partial rows of the public matrices, and then generate N CVP-instances to recover the hidden noisy matrices. Finally, we show how to obtain a group of equivalent private keys from the noisy matrices.\nA. Linear Relationship between Public Keys and Private Keys Theorem 1. Let B be an (n + 1)N × 2N matrix, and P, ε be two (n + 1)N × N matrices such that B = (B 0 , B 1 , · · · , B n ) T , P = (P 0 , P 1 , · · · , P n ) T and ε =\n(ε 0 , ε 1 , · · · , ε n ) T , where the matrices B i , P i , ε i , 0 ≤ i ≤ n are described as above. Deﬁne lattice\nThen each column of matrix ε is a vector belongs to lattice L.\n   \n   \n   \n   \n   \n   \n   \n   \n   \nFrom the deﬁnition of lattice L, each column of the matrix ε is a vector that belongs to lattice L.\n   \n   \n   \n   \nTo recall the special structure of each matrix above, each B i is N × 2N matrix and ε i is a square matrix with dimension N . For i ∈ {0, 1, · · · , n}, the elements of ε i are over {−1, 1}, except each diagonal term of matrix ε 0 is −q or q.\nRemark 1. Note that q is much smaller than p, so each column of ε is a short vector of L. Obviously, lattice L is spanned by\nthe columns of (n + 1)N × (n + 3)N matrix E, where E = B pI . As the rank of lattice L reaches (n + 1)N = 500,\nthe existing lattice reduction algorithms can not ﬁnd a short vector effectively.\nTo overcome this difﬁculty, we construct a new reduced- dimension lattice\nwhere (2N + k) × 2N matrix A is truncated from the ﬁrst 2N + k rows of matrix B. It is easy to verify that,\nwhere ε 2[1−k] is the ﬁrst k rows of ε 2 . Because every column vector of ¯ ε includes a large q, each column vector may not be the shortest vector of lattice L . In order to remove the impact of q, we generate the target vectors as t i = (0, 0, · · · , 0, q, 0, · · · , 0) for 1 ≤ i ≤ N , q is located at the i-th position. We expect that the i-th column vector of ¯ ε is the closest vector to target t i . The distance between t i and L is,\nWe use Kannan\u2019s embedding technique [17] to solve the CVP- instances CVP(t i , L ). Firstly, we obtain a short basis S of L\nby running the lattice reduction algorithm, and then construct N embedding lattices as\nWe will prove that each ε i is the shortest vector of the new lattice L i with a high probability. Once we have recovered the i-th column of the noisy matrix, we can obtain the i-th column of the bridge matrix D by solving a linear system of equations. Furthermore, the whole noisy matrix can be recovered by Equation (4).\nTheorem 2. Let p be a prime, such that p \t 2N . Choose k = \t 2N log(2πe) 2 log p−log(2πe) + 4, then for all but a fraction 1 p of the S\u2019s in Z (2N +k)×(2N ) p \t , the vector (Sd i − t i , −1) T is the shortest vector of lattice L i deﬁned as above, where d i is the i-th column of matrix D.\nwhere ε ij ∈ {−1, 1} for j = i and ε ii = 0. The length of each vector is\n2N + k is a shortest vector for all but a fraction 1 p of the S\u2019s.\nWithout loss of generality, suppose vector (v j , −j) T ∈ L i , for some j from {0, 1, · · · , p − 1}. Then we have\nLet N (n, R 2 ) denote the number of integer points in B n (R), where B n (R) represents the n-dimension ball cen- tered at the origin with radius R.\nSince p is a prime, for uniformly random choice of matrix S, any non-zero vector x ∈ Z 2N and a ﬁxed j, we have\nTherefore, for all but a fraction less than p −2 of the S ∈ Z (2N +k)×2N p \t , there is no vector shorter than R in V j .\nConsider all sets V j , with probability (1 − p −2 ) p ≈ 1 − p −1 , all vectors in L i is larger than R except the one (Sd i − t i , −1) T .\nTo sum up, we formalize an algorithm to recover the bridging matrix and noisy matrix below (Algorithm 1).\nOnce we have recovered the noisy matrix ε and the corre- sponding bridging matrix D, note that\nTo ensure the invertibility of matrix (∆ 1 |∆ 2 ), we should construct the two matrices ∆ 1 and ∆ 2 such that gcd(det((∆ 1 |∆ 2 )), p) = 1. From Equation (8), we have\nRandomly choose a 2N × N matrix ∆ 1 until we can get an appropriate matrix ∆ 1 such that gcd(det(∆ 1 |D), p) = 1.\nRandomly generate an N × N matrix M , compute ∆ 2 = ∆ 1 M + D, then the scrambling matrix ∆ −1 = (∆ 1 |∆ 2 ) is constructed. Choose a random N × N invertible matrix M 1 over Z/pZ, then compute M 2 = M 1 M , the hidden matrix M = (M 1 |M 2 ) is found. Finally, we get a set of equivalent private keys.\nRemark 2. For the correctness of our series of equivalent private keys, recall that\nBecause ∆ 2 = ∆ 1 M + D, we can calculate e = (m, r 1 , · · · , r n )ε as well.\nWe summarize the whole algorithm which leads to ﬁnd the group of equivalent private keys below (Algorithm 2).\nTo validate the efﬁciency of our attack, we implemented the attack using the NTL library [28] developed by Victor Shoup.\nInstance 1 Instance 2 Instance 3 k \t 10 \t 8 \t 35\nIn our attack, we invoked the lattice reduction algorithm BKZ- 20 [27] with reduction parameter 0.99.\nIn our tests, we enlarged the value k a little compared with the estimated value in Theorem 2 to ensure the embedding lattice would produce a bigger λ 2 -gap. In order to give a more exact estimation, we performed ten experiments for each set of recommended parameters. To illustrate the accuracy of the estimation of k value from Theorem 2, we summarize the experimental data in Table 1 for the third recommended parameters n = 9, p = 2 18 , q = 2 12 , m 0 = 32, r 0 = 5. The second row of Table 1 represents the k selections that we can successfully compute the noisy matrix for all the ten experiments. Corresponding with the three recommended groups of parameters, we did experiments for each instance and summarize the gaps of the embedding lattices and the choices of k in Table 2.\nIn this paper, we describe a reduced-dimension attack on the MCG homomorphic scheme. For the instances of the three sets of recommended parameters, the equivalent private keys can be recovered practically. The main contribution of our attack is to explore a secret linear equation between the public keys and the private keys, and then recover the private keys by solving a special closest vector problem.\nWe would like to thank Professor Phong Nguyen for his helpful comments.\nThis work is partially supported by NSF of China un- der grants No.61133013 and No.60931160442, and Ts- inghua University Initiative Scientiﬁc Research Program No.2009THZ01002."},"refs":[{"authors":[{"name":"J. Benaloh"},{"name":"D. thesi"}],"title":{"text":"Veriﬁable secret-ballot elections"}},{"authors":[],"title":{"text":"Zvika Brakerski and Vinod Vaikuntanathan"}},{"authors":[],"title":{"text":"Dan Boneh, Eu-Jin Goh, and Kobbi Nissim"}},{"authors":[{"name":"J. Fischer"}],"title":{"text":"Cohen, : A Robust and Veriﬁable Cryptographically Secure Election Scheme, FOCS, pp"}},{"authors":[{"name":"J.-S. Coro"},{"name":"A. Manda"},{"name":"D. Naccach"},{"name":"M. Tibouchi"}],"title":{"text":"Fully homomor- phic encryption over the integers with shorter public-keys"}},{"authors":[{"name":"Q. Nguyen"}],"title":{"text":"Yuanmi Chen and Phong  Faster Algorithms for Approximate Common Divisors: Breaking Fully-Homomorphic-Encryption Chal- lenges over the Integers,Cryptology ePrint Archive, Report 2011/436, 2011, http://eprint"}},{"authors":[{"name":"H. (ed"}],"title":{"text":"Dijk,M"}},{"authors":[],"title":{"text":"Damgard, I"}},{"authors":[],"title":{"text":"Taher El-Gamal"}},{"authors":[{"name":"D. thesi"}],"title":{"text":"Gentry, C"}},{"authors":[],"title":{"text":"Gentry, C"}},{"authors":[],"title":{"text":"Craig Gentry"}},{"authors":[{"name":"G. (ed"}],"title":{"text":"Gentry, C"}},{"authors":[{"name":"S. Goldwasse"},{"name":"D. Kharchenko"}],"title":{"text":"Proof of plaintext knowledge for the Ajtai-Dwork cryptosystem"}},{"authors":[{"name":"S. Goldwasse"},{"name":"S. Micali"}],"title":{"text":"Probabilistic encryption and how to play mental poker keeping secret all partial information"}},{"authors":[],"title":{"text":"R"}},{"authors":[{"name":"A. Kawach"},{"name":"K. Tanak"},{"name":"K. Xagawa"}],"title":{"text":"Multi-bit cryptosystems based on lattice problems"}},{"authors":[],"title":{"text":"Lipmaa, H"}},{"authors":[{"name":"A. Melcho"},{"name":"G. Castagno"},{"name":"P. Gaborit"}],"title":{"text":"C"}},{"authors":[],"title":{"text":"Aguilar Melchor, C"}},{"authors":[],"title":{"text":"J"}},{"authors":[],"title":{"text":"D"}},{"authors":[{"name":"P. Paillier"}],"title":{"text":"Public-Key Cryptosystems Based on Composite Degree Residuosity Classes"}},{"authors":[{"name":"C. Peiker"},{"name":"B. Waters"}],"title":{"text":"Lossy Trapdoor Functions and Their Appli- cations"}},{"authors":[{"name":"R. Rives"},{"name":"L. Adlema"},{"name":"M. Dertouzos"}],"title":{"text":"On data banks and privacy homomor- phisms"}},{"authors":[{"name":"C. P. Schnorr"}],"title":{"text":"A hierarchy of polynomial lattice basis reduction algo- rithms"}},{"authors":[{"name":"V. Shoup"}],"title":{"text":"NTL, Number Theory C++ Library"}},{"authors":[{"name":"D. (eds"}],"title":{"text":"Smart, N"}},{"authors":[{"name":"T. Okamot"}],"title":{"text":"Uchiyama"}}]},"file":{"jsonClass":"File","file":"/home/arnfred/Code/trailhead/resources/isit2012/1569566429.pdf"},"links":[{"id":"1569566157","weight":3},{"id":"1569566925","weight":3},{"id":"1569557083","weight":3},{"id":"1569565279","weight":6},{"id":"1569556361","weight":3},{"id":"1569565035","weight":3}],"meta":{"jsonClass":"HashMap$HashTrieMap","sessionid":"S12.T6.1","endtime":"11:50","authors":"Jingguo Bi, Mingjie Liu, Xiaoyun Wang","date":"1341487800000","papertitle":"Cryptanalysis of a Homomorphic Encryption Scheme from ISIT 2008","starttime":"11:30","session":"S12.T6: Cryptanalysis and Distributed Guessing","room":"Kresge Rehearsal A (033)","paperid":"1569566429"},"cluster":{"jsonClass":"Map$EmptyMap$"}}
