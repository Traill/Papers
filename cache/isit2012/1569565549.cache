{"id":"1569565549","paper":{"title":{"text":"Controlled Sensing for Sequential Multihypothesis Testing"},"authors":[{"name":"George K. Atia"},{"name":"Venugopal V. Veeravalli"}],"abstr":{"text":"Abstract\u2014The problem of controlled sensing for multihypoth- esis testing is considered. Prior to decision making, a controller sequentially chooses among a set of control actions to shape the quality of the observations. The goal is to design an efﬁcient con- trol policy, a stopping rule and a ﬁnal decision rule, to minimize the expected stopping time subject to hard constraints on the risks associated with wrong decisions about each hypothesis. We propose a sequential test, which is shown to be asymptotically optimal when the risks are sufﬁciently small. Optimality is based on a derived lower bound on the minimum expected stopping time of tests in the class of tests satisfying the predeﬁned risk constraints. Furthermore, by viewing the variable-length coding problem as a special case of sequential multihypothesis testing with observation control, we recover the classic result of Burnaˇsev on the expected coding length for variable-length coding over Discrete Memoryless Channels (DMCs) at zero rate."},"body":{"text":"Controlled sensing refers to adaptively managing and con- trolling multiple degrees of freedom in an information- gathering system to fulﬁll the goal of a given inference task. It has immediate implications in various applications, including infrastructure monitoring systems, surveillance systems and sensor networks.\nIn this paper, we consider the problem of multihypothesis testing with observation control. In contrast to [1], where the main focus was on hypothesis testing with a ﬁxed sample size, here we focus on the sequential setup. The goal is to optimize the tradeoff between reliability and detection delay. At each time instant, prior to making a decision about the hypothesis, the decision-maker sequentially chooses among a set of available controls to shape the quality of the obser- vations. The controller can adaptively choose when to stop taking measurements. Hence, an admissible sequential test is fully described through a causal control policy, a stopping rule and a ﬁnal decision rule. In contrast to the ﬁxed sample size scenario considered in [1], the error exponent is not a good metric for the optimality of a sequential test, since the expected stopping time depends on the underlying hypothesis.\nIn [2], the problem of binary sequential hypothesis testing without control was considered. Therein, the optimal expected stopping time is characterized subject to constraints on the probability of error under each hypothesis. It was shown that the Sequential Probability Ratio Test (SPRT) is optimal, i.e., of\nall tests with the same power the SPRT requires on average the smallest number of observations. This result was extended in [3] to the case of multiple hypothesis testing and a sequential test was proposed. This test was later shown to satisfy certain asymptotic optimality conditions [4].\nThe problem of sequential binary hypothesis testing with observation control was considered in [5] and an asymptot- ically optimal sequential test was presented. However, the result in [5] was restricted to binary hypothesis testing. More importantly, other than satisfying asymptotic optimality subject to vanishing error probabilities, no strict guarantees on the actual performance were provided. Hence, it remains unclear how would one design a test to meet speciﬁc error probability requirements even for the binary case. A Bayesian version of the sequential problem (with observation control) was considered in [6] in the non-asymptotic regime. Since the optimal policy is generally hard to characterize, certain conditions under which the optimal control is shown to be an open-loop control, i.e., one which does not depend on measurements, were identiﬁed. In this paper, we generalize the result in [5] to the case of multihypothesis testing, subject to hard constraints on the risks associated with wrong decisions about every hypothesis in the asymptotic setting where the risks are sufﬁciently small. For zero-one loss functions, the risk corresponds to the frequentist error probability, which represents the probability of accepting a given hypothesis incorrectly. Designing a test that satisﬁes strict constraints provides a recipe for efﬁcient test design. We also show that the classic result of Burnaˇsev [7] on the expected coding length for variable length coding can be recovered from the result in this paper by regarding the coding problem as a special case of controlled multihypothesis testing. It is worth mentioning that variable-length coding was considered from a control theoretic perspective in [8] and a parallel connection to active sensing was established in a dynamic programming framework.\nThe rest of the paper is organized as follows. In Section II, the problem setup is described. A lower bound on the optimal expected stopping time is presented in Section III. In Section IV, we present a sequential test, which is shown to be asymptotically optimal. A connection to variable-length channel coding is explored in Section V. Finally, conclusions are given in Section VI.\nConsider a sequential hypothesis testing problem of M simple hypotheses: H i , i ∈ M {0, . . . , M − 1}, where at each time the measurement takes values in X and the control takes values in U. The control set U is assumed to be ﬁnite. Under each hypothesis H i , i = 0, . . . , M −1, and at each time k, conditioning on the current control u k = u, the current observation X k is assumed to be conditionally independent of past measurements and past controls\n( x k −1 , u k −1 ) , where ( x k −1 , u k −1 ) ((x\nand to be conditionally distributed with density p u i (x). We consider causal control, where at each time k, the control U k can be any (possibly randomized) function of past measure- ments and past controls, i.e., U k , k = 2, 3, . . . , n, is described by an arbitrary conditional pmf q (k) = q k\nand U 1 is distributed according to a pmf q 1 (u 1 ). Under the aforementioned memoryless assumption, the joint distribution of (X n , U n ) under each hypothesis H i , p i (x n , u n ) , i = 0, . . . , M − 1, can be written as\nAt each time instant the controller has to decide whether to take more observations or to stop and make a decision about the unknown hypothesis. If the controller decides to take an observation, the controller selects one of the possible actions in U and a positive cost is incurred. If the controller decides to stop at time N = n, a decision is made according to the decision rule δ : X n × U n → M.\nLet F k be the σ-ﬁeld generated by (X k , U k ). An admissible sequential test γ = (ϕ, N, δ) consists of a causal observation control policy ϕ, deﬁned through (conditional) distributions as before, an F k -stopping time N and a ﬁnal decision rule δ. Clearly, there is a tradeoff between the performance of the test and the expected time to reach the ﬁnal decision. Our goal is to design an efﬁcient test to optimize this tradeoff. More speciﬁcally, we would like to design a test with minimum expected delay subject to constraints on the error probabilities.\nLet (π 0 , . . . , π M −1 ) be the prior distribution of the hypothe- ses. For i ̸= j, α ji = P j (δ = i) is the probability of accepting H i when H j is true, where P j is a probability measure under hypothesis j. Then, the risk for test γ associated with making a decision δ = i, which is the probability of incorrectly deciding i, is given by\nWe now introduce a class of tests for which the risks do not exceed predeﬁned numbers ¯ R i , i = 0, 1, . . . , M − 1, i.e.,\nnumbers. Deﬁne the largest threshold as ¯ R max = max i ∈M ¯ R i . The goal is to ﬁnd a test that minimizes the expected stopping time among the class Γ( ¯ R) in an asymptotic setting, i.e., when the risks are sufﬁciently small.\nBefore we state our results we ﬁrst introduce some more no- tation. The quantity d u ij is the Kullback-Leibler (KL) distance between the two densities p u i and p u j [9], i.e., d u ij D(p u i ||p u j ). Also deﬁne d ∗ i as\nand denote by q ∗ i the corresponding maximizing distribution. If P n i is the restriction of measure P i to the σ-algebra F n ,\nthen the Log-Likelihood Ratio (LLR) of i w.r.t. a dominating measure Q n is deﬁned as\nAlso, let Z ij denote the LLR between hypotheses H i and H j , which is the LLR when Q = P j , i.e.,\nThe following theorem establishes a lower bound on the expected stopping time of any test in the class Γ( ¯ R) as the risks go to zero.\nTheorem 1: (Lower bound) Let Γ( ¯ R) denote the class of tests deﬁned in (3) and ¯ R max → 0. Then, ∀i ∈ M, the expected stopping time satisﬁes\nwhere d ∗ i is deﬁned in (4) and o(1) → 0 as ¯ R max → 0. E i [.] denotes the expectation w.r.t. measure P i .\nTo prove this result, we ﬁrst prove the following lemma. Lemma 1: For the class of tests Γ( ¯ R) in (3)\nIt is not hard to see that Theorem 1 follows immediately from Lemma 1 and Markov inequality.\nLemma 2: If N is the stopping time of a test γ ∈ Γ( ¯ R), then\nfrom the deﬁnition of R i in (2) and the fact that γ ∈ Γ( ¯ R), we have the following set of inequalities\nwhere µ is a properly deﬁned measure. (a) follows from the fact that Z ij (n) < ρ | log ¯ R i | on Q n . Hence,\nwhich goes to 0 as ¯ R max → 0, for every 0 < ρ < 1. Thus, P i {Z ij (n) < ρ | log ¯ R i |} ≤ ∞ ∑\n. The R.H.S. of (11) goes to 0 as ¯ R max → 0. The result in Lemma 2 follows.\nThe following result follows from a standard martingale convergence argument as in Lemma 5 in [5] and is omitted due to space constraints.\nCombining the result in Lemma 2 and (12) Lemma 1 follows. Speciﬁcally,\nIn this section, we propose a sequential test γ a by modifying a test proposed in [4] to account for observation control. Let L i (n) denote the Generalized Likelihood Ratio (GLR) between hypothesis H i and the remaining hypotheses, i.e.,\nTo specify the test γ a we need to deﬁne the control policy, the stopping and the decision rules.\nControl policy: If at time k we decide to continue taking observations, then we select a control u k+1 ∈ U by sampling from the distribution\nis the maximizing distribution as deﬁned in (4).\nwhere b i , i = 0, 1, . . . M − 1, are design thresholds (to be speciﬁed).\nIn other words, we stop as soon as the GLR exceeds a predeﬁned threshold for some i and decide that this i is the true hypothesis.\n, i = 0, 1, . . . , M . Then, test γ a with control policy (15), stopping rule (16) and decision rule (17), belongs to the class Γ( ¯ R) deﬁned in (3).\nProof: Suppose i is the true hypothesis. For any j ∈ M, j ̸= i, deﬁne the set A n,j in the sample space as\nStep (a) is true since the denominator in (14) is maximized over the set M\\{j} and i is one index in that set. Step (b) follows since the test ends at n and the stopping criteria must be met for the choice of b j in the statement of Lemma 3. Thus,\nπ i α ij , it follows that R j ≤ ¯ R j . Since the result holds for all j, test γ a ∈ Γ( ¯ R).\nIn this section, we show that the expected stopping time of test γ a matches the lower bound in Theorem 1 asymptotically. For notation, f ∼ g means that f is asymptotically equal to g, i.e., f /g → 1. We prove the following theorem.\nTheorem 2: The expected stopping time E i [N a ], i = 0, 1, . . . M − 1, of sequential test γ a deﬁned through control policy (15), stopping rule (16) and decision rule (17), and risk constraints ¯ R i , i = 0, 1, . . . M − 1, satisﬁes\nThe main difﬁculty arises from the fact that unlike the tradi- tional sequential hypothesis testing problem where the LLRs\nare i.i.d. [3] [10], the LLRs are no longer i.i.d. with obser- vation control. Theorem 4.2 in [4] establishes the asymptotic optimality for general statistical models, i.e., without the i.i.d. assumption when the r-quick convergence condition holds. The main idea we need from that theorem is that if the LLRs\nZ ij (n) converge under the i-th measure r-quickly to positive constants ℓ ij , i ̸= j, then the r-th moment of the sample size required for the LLRs to cross predeﬁned thresholds is governed by the minimum constant min j ℓ ij . Note that for the purpose of this paper we are only interested in optimality relative to the expected stopping time and not relative to higher moments of the stopping time distribution. Hence, to establish (22) it sufﬁces to prove the 1-quick convergence 1 of the random variable 1 n Z ij (n). Speciﬁcally, since d ∗ i can be written as\nwe would like to show that 1\nwhere q ∗ i is the maximizing distribution in (4). To show 1- quick convergence, we need to show that ∀ϵ > 0, E i [T (ϵ)] is bounded, where\nHence, given the deﬁnitions of T 1 in (25) and T 2 in (26), to show that E i [T ] < ∞ it sufﬁces to show that there are numbers γ 1 , γ 2 < 1 such that, for any ϵ 1 , ϵ 2 > 0, the following two inequalities hold\nsince the expectation will then be bounded by sums of decreasing geometric series. The conditions in (27) and (28) are veriﬁed and the proof is deferred to the appendix. This establishes the asymptotic optimality of test γ a and proves Theorem 2.\nIn this section, we show that the variable-length channel coding problem can be viewed as a special case of sequential hypothesis testing with observation control. Then, we show that the classic result of Burnaˇsev [7] on the optimal code length for variable-length coding over DMCs can be recovered from the result derived in this paper on the optimal stopping time for M -ary controlled sequential hypothesis testing. First, we show how the problem of variable-length coding can be mapped to a sequential hypothesis testing problem.\nConsider a DMC, with a ﬁnite input alphabet Z, a ﬁnite channel output alphabet X , and a channel deﬁned through transition probabilities W (x |z). If we assume perfect causal feedback, the variable length block code is deﬁned by an encoder and a decoder. The encoder function z k (., .) : M × X k −1 → Z at time k determines the channel input z k (i, x k −1 ) based on the message i ∈ M = {0, 1, . . . , M − 1}, and past channel outputs x k −1 . At the decoding time N , which is a stopping time w.r.t. the receiver observation, the decoder computes ˆi = δ(x N ) ∈ M. In [7] Burnaˇsev determined the reliability function of variable length-coding over DMCs with feedback. He showed that\nwhere C 1 = max z,z \u2032 D(W (. |z)||W (.|z \u2032 )), P e denotes the error probability, and C denotes the channel capacity.\nFor communication at zero rate, i.e., when log M E[N] → 0 (for example when M is ﬁxed), the ﬁrst term on the R.H.S. in (29) is dominated by the second and,\nNow we view the variable-length coding problem as a con- trolled sequential sensing problem, namely, the message set M corresponds to the set of hypotheses, the channel output corresponds to the observations. Deciding on a decoding time corresponds to the stopping rule and decoding plays the role of the decision rule. While the encoding strategy for choosing the channel input Z k at every time instant can also be viewed as analogous to the control policy for choosing the control U k , there are still major differences in the informational structures. Speciﬁcally, the channel input Z k at time k depends on the message, when the control U k at time k cannot depend on the unknown hypothesis. Furthermore, the transition proba- bility W (x k |z k ) is independent of the message, unlike the observation model p u i (x k ) which depends on the underlying hypothesis.\nDespite the aforementioned differences in their information structures, it is not hard to see that the channel coding problem can be treated as a special case of the sequential hypothesis testing with control if at each time k we con- sider the M ×1 vector (z k (0, x k −1 ), z k (1, x k −1 ), . . . , z k (M − 1, x k −1 )) ∈ Z M to correspond to the control u k ∈ U. Particularly, for the equivalent sequential hypothesis testing\nproblem, we take the control set U = Z M . For a control u = (z(0), z(1), . . . , z(M − 1)) the observation model is simply p u i (x) ≡ W (x|z(i)). Now consider equiprobable messages, i.e., π i = 1/M for all messages. Given that we have posed the channel coding problem as a hypothesis testing problem, we can simply invoke Theorem 1 to compute a bound on the expected coding length, subject to a constraint on the error probability P e ≤ ϵ, ϵ → 0. We just need to compute d ∗ i in (4) for the equivalent hypothesis testing problem. Based on the previous analogy, and recalling that u is on the form u = (z(0), z(1), . . . , z(M − 1)),\nBecause of the symmetry of the transition probability for all channel inputs, the inner minimization over j in (31) is superﬂuous. Consequently, the outer maximization over q(u) is achievable by a point mass distribution at the two most distinguishable channel input symbols, i.e. d ∗ i = C 1 , ∀i, where C 1 is deﬁned after (29). Note that for the symmetric setup where ¯ R i = ϵ/M , it follows that E[N] ∼ log(1/ϵ) C\n, which is Burnaˇsev\u2019s bound at zero rate in (30).\nWe considered the problem of controlled sensing for se- quential multihypothesis testing. We derived a lower bound on the expected stopping time subject to hard constraints on the risks associated with wrong decisions. We also proposed a test which was shown to be asymptotically optimal. Our result generalizes the classic result of Chernoff to tests that are designed to meet speciﬁc performance requirements. Further- more, we showed that the problem of variable length-coding can be regarded as a special case of controlled multihypothesis testing and hence recovered Burnaˇsev\u2019s bound on the expected code length for variable-length coding over DMCs at zero rate.\nThe condition in (28) follows directly from the consistency of the GLR estimator, i.e., ˆi k → i w.p. 1 (with probability 1), where i is the true hypothesis. Consequently q (k) → q ∗ i w.p. 1. Deﬁne T 3 as the ﬁrst time such that ˆi k = i, ∀n ≥ T 3 . Then,\nfor some constant K > 0. Hence, by the consistency of the GLR estimator and the ﬁniteness of the set M\n− d u ij + ϵ 1 has a positive mean, and its moment generating function, ϕ(s) = E[e sW ], is ﬁnite for −1 ≤ s ≤ 0 for all u ∈ U and j ∈ M. Hence, there exists some s ∗ (ϵ 1 ) < 0 and η(ϵ 1 ) > 0 such that\nThe other side of the inequality can also be proven following the same argument. Condition (27) follows.\nThis work was supported by the Air Force Ofﬁce of Scientiﬁc Research (AFOSR) under the Grant FA9550-10-1- 0458 through the University of Illinois at Urbana-Champaign, by the U.S. Defense Threat Reduction Agency through sub- contract 147755 at the University of Illinois from prime award HDTRA1-10-1-0086, and by the National Science Foundation under Grant NSF CCF 11-11342."},"refs":[{"authors":[{"name":"S. Nitinawarat"},{"name":"G. K. Atia"},{"name":"V. V. Veeravalli"}],"title":{"text":"Controlled sensing for hypothesis testing"}},{"authors":[{"name":"A. Wal"}],"title":{"text":"Sequential Analysis"}},{"authors":[{"name":"C. Baum"},{"name":"V. V. Veeravalli"}],"title":{"text":"A sequential procedure for multiple hypothesis testing"}},{"authors":[{"name":"V. P. Dragalin"},{"name":"A. G. Tartakovsky"},{"name":"V. V. Veeravalli"}],"title":{"text":"Multihypothesis sequential probability ratio tests\u2013part I: Asymptotic optimality"}},{"authors":[{"name":"H. Chernoff"}],"title":{"text":"Sequential design of experiments"}},{"authors":[{"name":"M. Naghshvar"},{"name":"T. Javidi"}],"title":{"text":"Active M-ary sequential hypothesis testing"}},{"authors":[{"name":"M. V. Burnaˇsev"}],"title":{"text":"Data transmission over a discrete channel with feedback. random transmission time"}},{"authors":[{"name":"M. Naghshvar"},{"name":"T. Javidi"}],"title":{"text":"Variable-length coding with noiseless feedback and ﬁnite messages"}},{"authors":[{"name":"T. M. Cove"},{"name":"J. A. Thoma"}],"title":{"text":"Elements of Information Theory"}},{"authors":[{"name":"V. Veeravalli"},{"name":"C. Baum"}],"title":{"text":"Asymptotic efﬁciency of a sequential multihypothesis test"}},{"authors":[{"name":"P. L. Hsu"},{"name":"H. Robbins"}],"title":{"text":"Complete convergence and the law of large numbers"}}]},"file":{"jsonClass":"File","file":"/home/arnfred/Code/trailhead/resources/isit2012/1569565549.pdf"},"links":[],"meta":{"jsonClass":"HashMap$HashTrieMap","sessionid":"S12.T8.2","endtime":"12:10","authors":"George Atia, Venugopal Veeravalli","date":"1341489000000","papertitle":"Controlled Sensing for Sequential Multihypothesis Testing","starttime":"11:50","session":"S12.T8: Hypothesis Testing","room":"Stratton (491)","paperid":"1569565549"},"cluster":{"jsonClass":"Map$EmptyMap$"}}
