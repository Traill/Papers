{"id":"1569566749","paper":{"title":{"text":"A Serial Concatenation of Coding and Trellis Shaping for OFDM Systems with Peak Power Reduction"},"authors":[{"name":"Ryota Yoshizawa"},{"name":"Hideki Ochiai"}],"abstr":{"text":"Abstract\u2014 Orthogonal \t frequency-division \t multiplexing (OFDM) can achieve remarkable performance in terms of spectral efﬁciency. However, its well-known drawback is that the OFDM signals have high peak-to-average power ratio (PAPR), and this causes performance degradation in terms of power ampliﬁer (PA) efﬁciency. Trellis shaping (TS) is an effective method to reduce PAPR without signal distortion by exploiting the trellis structure at the transmitter. In practice, OFDM should be combined with channel coding in order to achieve frequency diversity. In this paper, we propose a serial concatenation of channel coding and trellis shaping such that the frequency diversity effect and peak power reduction can be simultaneously achieved. A novel BCJR-based LLR metric calculation for trellis shaping bits is introduced for this purpose. The effectiveness of the proposed approach is conﬁrmed by simulation over AWGN and frequency-selective fading channels."},"body":{"text":"Orthogonal frequency-division multiplexing (OFDM) has excellent performance in terms of spectral efﬁciency as well as its robustness against frequency-selective fading channels. OFDM signaling is thus adopted by various wireless com- munications systems, including wireless local area networks (LAN) and 3GPP long term evolution (LTE). The well-known drawback of the OFDM signal is its high peak-to-average power ratio (PAPR). As a result, linear ampliﬁcation of OFDM signal requires a large input back-off (IBO) operation of the power ampliﬁer (PA) at the ﬁnal stage of the transmitter, and this substantially degrades its power efﬁciency.\nVarious techniques have been proposed for PAPR reduction of OFDM signals. One of the simplest methods is the delib- erate clipping and ﬁltering (CAF) (e.g., [1, 2]). This approach causes nonlinear in-band distortion and thus is difﬁcult to be applied to the communication standards that have a strict limitation in terms of error vector magnitude (EVM). Selected mapping (SLM) [3] is another well-known approach but its peak power reduction capability is limited, considering the increase of transmitter complexity and the side information overhead required for every OFDM symbol. Furthermore, these two methods consider only PAPR reduction and they in general may not be used for average power reduction.\nTrellis shaping (TS) is known as a ﬂexible method to reduce PAPR and average power of OFDM signals by controlling signal transition exploiting the structure of trellis codes. Since\nTS neither requires transmission of side information nor in- troduces nonlinear distortion, it is applicable to many systems with severe EVM limitation.\nTS was originally proposed for average power reduction of QAM signals by Forney [4]. It was then applied to peak power reduction of single-carrier signals in [5]. Recently, by extending this approach, it is demonstrated in [6] that near constant envelope single-carrier signals can be generated. On the other hand, the application of TS to PAPR reduction of OFDM signals was proposed in [7], and a low-complexity technique that makes use of the autocorrelation property of transmit symbols in frequency domain was proposed in [8]. More recently, the use of sequential decoding together with a time-domain metric is proposed in [9] for computational complexity reduction.\nIn general, TS for PAPR reduction requires constellation expansion similar to coded modulations (CM), but unlike CM it does not offer any error correcting capability. This indicates that the relative noise margin is reduced. In other words, if we compare the system with and without TS under the same energy constraint per information bit, there is a performance degradation for the former in terms of bit error rate (BER) or corresponding required signal-to-noise power ratio (SNR) unless average power is also reduced.\nIt is well known that channel coding is essential for OFDM systems to achieve frequency diversity over frequency- selective fading channels. However, to the best of the authors\u2019 knowledge, coded modulation performance of trellis shaped OFDM system with PAPR reduction over frequency-selective fading channels has not been rigorously investigated yet.\nIn this paper, we propose a serial concatenation of channel coding and trellis shaping in the framework of OFDM with PAPR reduction. To extract the soft output from the trellis shaping bits that are originally designed for PAPR reduction, a novel BJCR-based log likelihood ratio (LLR) calculation is introduced. As outer binary codes, both low-density parity- check (LDPC) codes and convolutional codes are investigated. The resulting proposed system can be seen as a special form of a bit interleaved coded modulation (BICM) [10, 11]. It will be shown that the proposed serial concatenation of LDPC codes and TS can signiﬁcantly improve the frame error rate performance.\nWe brieﬂy review the TS system for OFDM with PAPR reduction. A basic block diagram of the general TS system is described in Fig. 1. In this ﬁgure, G denotes the generator matrix of a convolutional code, H T and\nthe parity check matrix and its left inverse matrix for this code, respectively. For a detailed description of trellis shaping for PAPR reduction, we refer to [8]. In the framework of trellis shaping, we control the signal transition by adding the codeword from encoder G to the most signiﬁcant bits (MSB) encoded with\na suitable codeword from G that minimizes the PAPR. In this paper, we use a rate-1/2 code for shaping and a Viterbi algorithm is used for searching for the codeword. As a metric of ﬁnding the suitable codeword, one may either use a time- domain (TD) metric proposed in [7, 9] or a frequency-domain (FD) metric proposed in [8]. In terms of PAPR distribution, the TD metric with higher complexity may achieve better performance [9]. Nevertheless, our previous study [12] shows that the FD metric outperforms the TD metric in terms of resulting bit error rates (BER) over nonlinear channels. Therefore, in this paper, we only review and evaluate the performance of the FD metric in what follows.\nThroughout this paper, we consider the so-called sign-bit shaping [4, 8] where each two-bit shaping output (as MSB) chooses the quadrant of the QAM constellation. Furthermore, as a QAM constellation mapping for TS, we consider the use of Type-1 and Type-2 mappings described in [8]. Type- 1 mapping consists of an origin-symmetric mapping for LSB and thus energy remains the same regardless of the selected quadrants. Consequently, Type-1 mapping does not reduce the average power and thus works exclusively for PAPR reduction. On the other hand, the Type-2 mapping does not have this property and is able to reduce both the peak and the average power of OFDM signals.\nThe FD metric is based on the fact that if the autocorrelation of the transmitted symbol sequence in frequency domain is close to an impulse, the resulting instantaneous power becomes ﬂattened (and thus the PAPR becomes lower).\nThis metric is deﬁned as a sum of squares of the autocor- relation sidelobes:\nwhere i is the level of trellis (i = 1, 2, · · · , N), R m denotes the aperiodic autocorrelation function of the mapping symbol sequence A = {A 0 , A 1 , · · · , A N −1 }, and N is the number of subcarriers per OFDM symbol. This minimization process can be transformed into a recursive form [8] as follows:\nwhere R (i) m = R (i −1) m + δ (i −1) m \t for i = 2, 3, . . . , N , m = 1, 2, . . . , i − 1, and δ (i) m \t A i A ∗ i −m . Note that, all possible entries δ (i) m and |δ (i) m | 2 can be computed and tabulated from the constellation mapping beforehand for computational com- plexity reduction.\nFinally, the sequence A is converted to time domain samples by (at least N -point) inverse fast Fourier transform (IFFT). By adding a guard interval of appropriate length and passing the signal through a low-pass ﬁlter, we obtain a continuous baseband OFDM signal.\nIn this paper, we consider the coded trellis shaping system in the form of serial concatenation of TS and channel coding as described in Fig. 2. The bit interleaving and deinterleaving are applied as shown in Fig. 2, where π denotes the bit interleaver, and π −1 denotes the corresponding deinterleaver. In this design, the information bits are encoded followed by separate bit interleavers. The encoded bits are then separated into MSBs and LSBs and former bits are encoded by (H −1 ) T\nfor shaping. After shaping, the MSBs and LSBs, where the merged and passed into the QAM mapper. At the receiver, we calculate the log likelihood ratio (LLR) of each received bit to enable soft decision decoding at the channel decoder. By using this LLR sequence in the decoding process after deinterleaving, one can decode the information. Different from directly channel coded cases as in the conventional BICM, the LLR calculation is somewhat complex in our model since the MSBs are generated by shaping after channel coding. In the following subsections, we detail our proposed calculation process.\nFor reference, we also consider the channel coding without bit interleaving, which corresponds to the system where the interleavers and deinterleavers are simply removed from those in Fig. 2.\nWith trellis shaping, hard decision is generally used for MSBs since the soft output may not be directly retrieved. We thus obtain the soft output of MSBs to improve the decoding performance by employing the BCJR algorithm [13]. We ﬁrst model the received OFDM symbol as follows. Let Y i denote the ith subcarrier of the received signal, which can be written as Y i = H i X i + N i where H i is the complex fading channel coefﬁcient, X i ∈ X is the transmitted symbol, and N i is the Gaussian noise term of the corresponding subcarrier. Note that X is the set of M-QAM symbols to be transmitted and we denote B = log 2 M as the number of bits constituting the symbol. With these notations, the bit likelihood for the jth bit of the ith subcarrier, µ b i,j , where j ∈ {0, 1, · · · , B−1} and i ∈ {0, 1, · · · , N −1}, is expressed by the a posteriori probability that indicates which bit (b ∈ {0, 1}) was transmitted:\nwhere X b j denotes the signal set whose jth bit is b ∈ {0, 1}, and C is a normalization constant which can be dropped in the actual implementation. Also, N 0 denotes the power spectral density of AWGN.\nTo enable soft-input soft-output (SISO) decoding at the receiver, we ﬁrst determine the trellis based on the compound matrix [14] of (H −1 ) T and G, and then employ a BCJR algo- rithm to it. For simplicity, we adopt the sign bit shaping and the entire codeword of TS is matched to an OFDM symbol. In this case, one bit out of B −1 bits is encoded by (H −1 ) T , and each subcarrier contains the corresponding two-bit outputs as MSB. We denote the coded bits (prior to trellis shaping) carried by the ith subcarrier as s i = [s 0 i s 1 i · · · s B −2 i ], and subsequently the corresponding binary sequence that forms the MSB of TS by s = [s 0 0 s 0 1 · · · s 0 N −1 ].\nFor the input s 0 i , we deﬁne the corresponding two-bit output [r 0 i , r 1 i ] from the encoder for trellis shaping, current state l = 0, 1, · · · , N s − 1 of decoding trellis, where N s denotes the number of states of the trellis. In the BCJR algorithm, we need to compute the forward recursion α i (l), the backward recursion β i (l), and the branch metric γ b i (l , l), prior to calcu- lating the actual soft output. Note that, r 0 i and r 1 i denote the ﬁrst and second bit of the ith subcarrier, respectively.\nwhere b denotes the value of s 0 i ∈ {0, 1}. Next, we compute α i (l) and β i (l) by the following recursive equations:\n(5) where we set the initial values of these parameter beforehand as\nThen we calculate the ith soft output Λ b i from MSB for each bit b ∈ {0, 1} as follows:\nIn this section, we evaluate frame error rate (FER) per- formance of the proposed system by computer simulation. Throughout simulations, we consider the sign-bit shaping described in [4, 8] for simplicity. The number of subcarriers is chosen as 128, and each subcarrier is modulated by 256- QAM constellation with either the Type-1 or Type-2 mapping. As concatenated error correcting codes, we used a rate-6/7 LDPC code and the same rate punctured convolutional code (CC). We set both the length of codeword of error correcting codes and the size of interleaver to 896(= 128 × 7) bits to\nmatch one OFDM symbol. In LDPC decoding, the maximum iteration count is set to 50. The constraint length is chosen as 3 for TS, and 7 for the convolutional code used for error correction. Note that, these codes are selected from those with maximum free distance. For complexity reduction, we apply the trellis window truncation [8] with the normalized window size ˜ ∆ = 1/2 to the TS. From the above description, the total coding rate of concatenated shaping system is calculated as 3/4 for both LDPC code and CC concatenated case. For comparison, we also show the performance of a rate-3/4 LDPC code without shaping. The codeword length of this code is 1024 bits and the maximum iteration count is 50. These parameters are chosen such that the overall bandwidth efﬁciency is the same (i.e., 6 bits per symbol).\nBefore we present the FER performance, we brieﬂy demon- strate the peak power reduction capabilities of TS. As a criterion for evaluating the peak-power reducing effect, we use the complementary cumulative distributed function (CCDF) of the instantaneous power of these signals. Figure 3 shows the CCDFs of normalized instantaneous power, for each of Type-1 and Type-2 mapping. From this ﬁgure, it is observed that we can considerably reduce the peak power compared to the unshaped case. Comparing Type-1 and Type-2, the former mapping can perform better, but the latter mapping can reduce the average power by about 3 dB compared to the unshaped case, while Type-1 has no capability of average power reduction [8, 12].\nFigures 4 and 5 show the FER performance of the proposed system with Type-1 and Type-2 mappings, respectively, over an AWGN channel. In both mappings, it is observed that TS with channel coding can achieve better performance. We observe that a gain in terms of E b /N 0 of about 2 dB and 5 dB\nat 10 −3 is achieved by the concatenation of CC and LDPC codes, respectively, compared to those without channel coding.\nMoreover, for the case of LDPC concatenated shaping, the improving effect of random interleaver can be observed. We conjecture the reason for this behavior as follows: the built- in interleaver of LDPC code may not be sufﬁcient and some check nodes thus refer to the LLR associated with TS in a non-uniform manner, based on the fact that the interleaver does not improve but rather degrades the performance of the LDPC code without shaping.\nThe FER performance over frequency-selective 4-path Rayleigh fading channel is shown in Figs. 6 and 7 for Type-1 and Type-2 mapping, respectively. For the simulated frequency-selective channel, a guard interval (GI) of length T /4 is inserted per OFDM symbol, where T is the OFDM\nsymbol length, and the delay spread is set shorter than the length of the GI. We also assume that the receiver has an ideal channel state information (CSI) and uses this information at the channel decoder to retrieve the original information bits correctly. Even though the performance over fading channels degrades in general, a similar tendency to the case of AWGN channel is observed. In particular, considerable performance gain can be achieved by channel coding compared to the uncoded case because of the effect of frequency diversity. Moreover, in this channel, a bit interleaving always improves the performance for coded cases.\nWe have investigated the FER performance of coded trellis shaping over AWGN and frequency-selective Rayleigh fading channels with and without bit interleaving. We have proposed a novel serial concatenation structure in this study and it has\nbeen shown that the use of LDPC codes for channel coding considerably outperforms the uncoded as well as CC-coded TS cases in both of AWGN and frequency-selective Rayleigh fading channels.\nFor our future work, we will make further investigations on the performance of coded trellis shaping over the nonlinear channels.\nThis work was supported in part by MEXT KAKENHI 23686058."},"refs":[{"authors":[{"name":"X. Li"},{"name":"L. J. Cimini"}],"title":{"text":"Effects of clipping and ﬁltering on the performance of OFDM"}},{"authors":[{"name":"H. Ochiai"},{"name":"H. Imai"}],"title":{"text":"Performance analysis of deliberately clipped clipped OFDM signals"}},{"authors":[{"name":"R. W. B¨auml"},{"name":"R. F. H. Fischer"},{"name":"J. B. Huber"}],"title":{"text":"Reducing the peak-to- average power ratio of multicarrier modulation by selected mapping"}},{"authors":[{"name":"G. D. Forney"}],"title":{"text":"Trellis Shaping"}},{"authors":[{"name":"I. S. Morrison"}],"title":{"text":"Trellis shaping applied to reducing the envelope ﬂuctuation of MQAM and band-limited MPSK"}},{"authors":[{"name":"M. Tanahashi"},{"name":"H. Ochiai"}],"title":{"text":"Near constant envelope trellis shaping for PSK signaling"}},{"authors":[{"name":"W. Henkel"},{"name":"B. Wagner"}],"title":{"text":"Another application for trellis shaping: PAR reduction for DMT(OFDM)"}},{"authors":[{"name":"H. Ochiai"}],"title":{"text":"A novel trellis-shaping design with both peak and average power reduction for OFDM systems"}},{"authors":[{"name":"T. T. Nguyen"},{"name":"L. Lampe"}],"title":{"text":"On trellis shaping for PAR reduction in OFDM systems"}},{"authors":[{"name":"E. Zehavi"}],"title":{"text":"8-PSK trellis codes for a Rayleigh channel"}},{"authors":[{"name":"G. Caire"},{"name":"G. Taricco"},{"name":"E. Biglieri"}],"title":{"text":"Bit-interleaved coded modula- tion"}},{"authors":[{"name":"R. Yoshizawa"},{"name":"H. Ochiai"}],"title":{"text":"Performance Comparison of Trellis- Shaped OFDM Systems over Nonlinear Channels"}},{"authors":[{"name":"L. R. Bahl"},{"name":"J. Cocke"},{"name":"F. Jelinek"},{"name":"J. Raviv"}],"title":{"text":"Optimal decoding of linear codes for minimizing symbol error rate"}},{"authors":[{"name":"T. Aoki"},{"name":"H. Ochiai"},{"name":"R. Kohno"}],"title":{"text":"Combined trellis precoding and error correcting codes in multi-user MIMO-OFDM systems"}}]},"file":{"jsonClass":"File","file":"/home/arnfred/Code/trailhead/resources/isit2012/1569566749.pdf"},"links":[{"id":"1569565223","weight":7},{"id":"1569566385","weight":3},{"id":"1569559665","weight":3},{"id":"1569566605","weight":3},{"id":"1569566683","weight":3},{"id":"1569566227","weight":3},{"id":"1569566697","weight":3},{"id":"1569566761","weight":3},{"id":"1569556029","weight":3},{"id":"1569565495","weight":3},{"id":"1569564805","weight":3},{"id":"1569565355","weight":3},{"id":"1569551535","weight":3},{"id":"1569566739","weight":3},{"id":"1569555811","weight":3},{"id":"1569562685","weight":14},{"id":"1569566157","weight":7},{"id":"1569564311","weight":3},{"id":"1569566419","weight":3},{"id":"1569566759","weight":3},{"id":"1569558859","weight":3},{"id":"1569565213","weight":3},{"id":"1569566643","weight":3},{"id":"1569565257","weight":3},{"id":"1569566687","weight":14},{"id":"1569566513","weight":3},{"id":"1569554971","weight":3},{"id":"1569562821","weight":25},{"id":"1569566649","weight":3},{"id":"1569565559","weight":3},{"id":"1569566913","weight":3},{"id":"1569566447","weight":11},{"id":"1569566141","weight":3},{"id":"1569556671","weight":3},{"id":"1569564973","weight":7},{"id":"1569565469","weight":3},{"id":"1569566655","weight":3},{"id":"1569565739","weight":3},{"id":"1569565463","weight":3},{"id":"1569566949","weight":3},{"id":"1569566383","weight":3},{"id":"1569565155","weight":3},{"id":"1569566177","weight":3},{"id":"1569559199","weight":3},{"id":"1569566929","weight":7},{"id":"1569565665","weight":3},{"id":"1569566983","weight":3},{"id":"1569556361","weight":3},{"id":"1569565241","weight":3},{"id":"1569566651","weight":3},{"id":"1569565177","weight":3},{"id":"1569566823","weight":3},{"id":"1569565013","weight":14},{"id":"1569565829","weight":22},{"id":"1569565375","weight":3},{"id":"1569565597","weight":3},{"id":"1569559035","weight":3},{"id":"1569566435","weight":7},{"id":"1569565769","weight":11},{"id":"1569566147","weight":3},{"id":"1569560785","weight":3},{"id":"1569565561","weight":11},{"id":"1569566847","weight":3},{"id":"1569566583","weight":3},{"id":"1569565737","weight":14},{"id":"1569566273","weight":3},{"id":"1569558697","weight":3},{"id":"1569566067","weight":3},{"id":"1569564807","weight":14},{"id":"1569566113","weight":3}],"meta":{"jsonClass":"HashMap$HashTrieMap","sessionid":"S8.T7.3","endtime":"17:40","authors":"Ryota Yoshizawa, Hideki Ochiai","date":"1341336000000","papertitle":"A Serial Concatenation of Coding and Trellis Shaping for OFDM Systems with Peak Power Reduction","starttime":"17:20","session":"S8.T7: Communication Theory","room":"Stratton (407)","paperid":"1569566749"},"cluster":{"jsonClass":"Map$EmptyMap$"}}
