{"id":"1569566855","paper":{"title":{"text":"Beyond the Bethe Free Energy of LDPC Codes via Polymer Expansions"},"authors":[{"name":"Nicolas Macris"},{"name":"Marc Vuffray"}],"abstr":{"text":"Abstract\u2014The loop series provides a formal way to write down corrections to the Bethe entropy (and/or free energy) of graphical models. We provide methods to rigorously control such expansions for low-density parity-check codes used over a highly noisy binary symmetric channel. We prove that in the asymptotic limit of large size, with high probability, the Bethe expression gives an exact formula for the entropy (per bit) of the input word conditioned on the output of the channel. Our methods also apply to more general models."},"body":{"text":"Often one needs to compute the free energy and/or entropy of a graphical model. The Bethe approximation and the related Belief Propagation (BP) equations may sometimes offer a good starting point. However it is seldom a controlled approximation and even worse it is usually not clear if it yields upper or lower bounds, or even if there is any such relationship. There are not many results that precisely pinpoint the relation between the Bethe and true free energies or entropies. A general result of Vontobel [1] relates the Bethe free energy to an average of the true free energy over all graph covers. For Ising-like graphical models with attractive pair interactions, Wainwright [2] has shown that, under additional special conditions, the Bethe free energy is a bound to the true free energy. This has been extended recently to a much wider setting (with \u201cattractive- like\u201d interactions) by Ruozzi [3]. For counting independent sets in sparse graphs with large girth, Chandrasekaran et al. [4] show that the Bethe free energy is asymptotically exact as the size of the graph grows. Works [2], [4] use the same loop series used here. It is well known that the Bethe free energy is exact on trees, and it is natural to investigate its possible exactness on random Erdoes-R´enyi type graphs which are known to be locally tree-like. But we already know of systems, such as random constraint satisfaction models (e.g, K-SAT or Q- coloring) or spin glasses, where the true free energy is not given by the Bethe formula - even when averaged over the graph ensemble. The local tree-like nature of the graph is not sufﬁcient when long ranged correlations are present [5].\nFor graphical models that describe communication with low density parity-check (LDPC) and low density generator-matrix (LDGM) codes over binary-symmetric memoryless channels the situation is favorable. Indeed we have plenty of evidence that the replica-symmetric solution 1 is exact. See [6], [7], [8]\nfor bounds and [9], [10] for results on the binary erasure channel. In [11] it is proven that correlations between pairs of distant (with respect to Tanner graph distance) bits decay exponentially fast for LDGM codes in the regime of large noise, and LDPC codes in the regime of small noise. This also allowed to conclude that the replica symmetric formulas are exact in these regimes.\nA few years ago Chertkov and Chernyak [12] developed a loop series representation for the free energy of graphical models. The virtue of this representation is that it isolates the Bethe contribution, and represents the remainder by a series of terms involving only BP messages associated to generalized loops of the graph. It is tempting to use this representation as a tool to compare the true and Bethe free energies.\nIn this contribution we consider regular LDPC(l, r) codes used over a highly noisy BSC, where (l, r) stands for the degree of variable node and check node respectively. Con- sider the conditional entropy 1 n H(X |Y ) of the input word X = (X 1 · · · X n ) given a channel output Y = (Y 1 · · · Y n ). We prove that in the large size limit, with high probability with respect to the code ensemble, the difference between the conditional entropy and the Bethe formula tends to zero. The error term essentially comes from the probability that the graph is not locally tree-like. Our techniques also allow to organize the dominant correction terms into a polymer expansion 2 involving generalized loops of size less than λ 0 n (0 < λ 0 < 1 a constant). As we will show, expander arguments imply that this polymer expansion converges uniformly in n. When the terms of the polymer expansion are added to the Bethe expression, with high probability, the difference with the conditional entropy becomes O(e −nϵ ) for some ϵ > 0.\nOur results also apply to more general models. Namely the channel could have asymmetric ﬂip probability. In fact the whole technique and results apply to spin-glass models on (l, r) Tanner graphs with l odd and l < r, with small magnetic ﬁelds, and any temperature.The limitation to l < r is not just technical. Indeed l > r would correspond to a kind of XORSAT constraint satisfaction problem, and for the usual XORSAT problem we know that the replica symmetric solutions are not generally exact at low temperatures.\nThe case l = 2 (cycle codes) has its own special features and has been discussed in [14].\nWe begin with a few deﬁnitions and notations. Fix two integers l < r. Consider two vertex sets: V a set of n variable nodes and C a set of m = n l r check nodes. We think of n large and l, r ﬁxed. We consider bipartite (l, r) regular graphs - call them Γ - connecting V and C. The set of edges is E. More precisely, vertices of V have degree l, vertices of C have degree r, and there are no double edges. The set of all such graphs is denoted B(l, r, n). Note that Γ is the Tanner graph of a LDPC code with design rate 1 −l/r. When we say that Γ is random we mean that we draw it uniformly randomly from the set B (l, r, n). The corresponding expectation is E Γ .\nLetters i, j will always denote nodes in V and letters a, b nodes in C. We reserve the notations ∂i (resp. ∂a) for the sets of neighbors of i (resp. a) in Γ.\nWe will say that Γ is a (λ, κ) expander if for every subset V ⊂ V such that |V| < λn we have |∂V| ≥ κl |V|. Here ∂ V is the number of check nodes that are connected to V. Take a random Γ. We can always ﬁnd λ > 0 such that with probability 1 − O(n −(l(1−κ)−1) ), Γ is a (λ, κ) expander with κ < 1 − 1 l . It is sufﬁcient to take 0 < λ < λ 0 where λ 0 is the positive solution of the equation 3\nh 2 (λ 0 ) − l r\nAs will be seen later we need to take κ ∈]1 − 2(r −1) lr , 1 − 1 l [ (which is always possible for r > 2). In the rest of the paper κ is always a constant in this interval, and 0 < λ < λ 0 . For concreteness, one can take the case (l, r) = (3, 6), ﬁx κ = 1/2 and λ 0 = 5 × 10 −4 .\nAssume that we transmit (with uniform prior) code words from an LDPC code with Tanner graph Γ over a BSC with ﬂip probability p. We assume without loss of generality that the all zero codeword is transmitted. Then the posterior probability that x = (x i ) n i=1 ∈ {0, 1} n is the transmitted word given that y = (y i ) n i=1 ∈ {0, 1} n is received, reads\n( x |y ) = 1 Z\n(2) The graph Γ enters in this formula through the parity check constraints. In this formula h i = ( −1) y i 1 2 ln 1 −p p and Z is the normalizing factor\nh = 1 2\np \t (4) It is good to keep in mind that the high noise regime consid- ered in this paper corresponds to small h (p close to 1/2) and that |h i | = h.\nIt is equivalent to describe the channel outputs in terms of y or in terms of the half-log-likelihood variables h = (h i ) n i=1 .\nNote that h i have the probability distribution c(h i ) = (1 − p)δ(h i − ln 1 −p p ) + pδ(h i − ln p 1 −p ). The expectation with respect to this distribution is called E h . We are interested in the conditional entropy H(X |Y ) of the input word given the output word. We have (see e.g, [5])\np . (5) In (5), n −1 ln Z is the free energy of the Gibbs measure (2).\nThe Bethe free energy involves a set of messages {η i →a , η a →i } attached to the edges of Γ. The collection of all messages is denoted (η, η). These satisfy the BP equations\nThese equations always have a trivial solution tanh η i →a = tanh η a →i =1. We will consider only non-trivial solutions that are relevant for small h. For these solutions η i →a and η a →i take small values and we can show that |η i →a | ≤ |h| + (l − 1) |h| r −1 + O( |h| r ) and |η a →i | ≤ |h| r −1 + O( |h| r ). We call such solutions high-noise-solutions.\nwhere     \nln (2 cosh η i →a ) , F i = ln\nTheorem 1: Suppose l is odd and 3 ≤ l ≤ r. There exists h 0 > 0 (small) independent of n, such that for |h| ≤ h 0 and any high-noise-solution\nRemark 1: By Markov\u2019s bound we obtain that the differ- ence between the true and Bethe free energies tends to zero with high probability, in the n → +∞ limit.\nRemark 2: We can average equation (7) over the channel output and use (5) to relate the true and Bethe entropies.\nWe deﬁne a generalized loop g as any subgraph contained in Γ with no dangling edges (ﬁgure 1). Note that a generalized loop is not necessarily connected and can be the empty set. We call d i (g) (resp. d a (g)) the induced degree of node i (resp. a) in g. For a generalized loop we have d i (g) ∈ {2, · · · , l} and d a (g) ∈ {2, · · · , r}.\nFor a ﬁnite size system, the loop series [12] is an identity valid for any solution of the BP equations. We have\n1 n\n( η, η ) = 1 n\nThe sum on the right hand side carries over all generalized loops included in Γ. The K(g) can be expressed entirely in terms of BP messages η i →a and η a →i . The explicit formula is given in the appendix. Remarkably K(g) factorizes in a product of contributions associated to the connected parts of g. Each generalized loop can be decomposed in a unique way as a union g = ∪ k γ k where γ k are connected and disjoint generalized loops. The γ k \u2019s are called polymers. We have K(g) =\nK(γ k ) and ∑\nK (γ k ) × ∏\nIn the sum each γ k runs over all polymers contained in Γ. The factor 1 M ! accounts for the fact that a polymer conﬁguration has to be counted only once. Finally the indicator function ensures that the polymers do not intersect (it equals 1 when M = 0, 1). Because of this constraint all sums in (9) are ﬁnite.\nFrom a physical point of view (9) is the partition function of polymers that can acquire any shape allowed by Γ, have activity 4 K(γ), and interact via a two body hard-core repul- sion. This analogy allows us to use methods from statistical mechanics to analyze the corrections to the Bethe free energy.\nWe say that a polymer is small if |γ| < λn for some ﬁxed λ that we take in the interval [0, λ 0 ]. The contribution of small polymers to (9) is\nK (γ k ) ∏\nTheorem 2: Suppose l is odd and 3 ≤ l ≤ r. take Γ at random. There exist a small h 0 independent of n such that for |h| < h 0 , and any high-noise-solution\nequations, with probability 1 − 1 ϵ O(n −(l(1−κ)−1) ), 1 n\nThe second term on the right hand side of (11) is the partition function of small polymers. One can compute in a systematic way the leading corrections to the Bethe free energy by expanding the logarithm in powers of the activities K(γ). This yields the so-called polymer (or Mayer) expansion,\n1 n\nThe third sum is over the set G M of all connected Mayer graphs G with M vertices labeled by γ 1 , ..., γ M (see ﬁgure 2). Note that in the expansion of the logarithm, the indicator function forces the polymers to overlap. Therefore the summa- tions contains an inﬁnite number of terms and its convergence has to be controlled.\nLemma 1: Suppose r > 2. Fix ζ 0 > 1 and replace K(γ) by ζK(γ) (ζ ∈ C) in the polymer expansion (12) which then becomes a power series in the parameter |ζ| ≤ ζ 0 . Assume that Γ is a (λ, κ) expander with κ ∈]1 − 2(r −1) lr , 1 − 1 l [. One can ﬁnd h 0 > 0 such that for |h| < h 0 this power series is absolutely convergent uniformly in n and h.\nRemark 4: Our real interest is of course for ζ = 1, and the introduction of the parameter ζ above is just a convenient way to describe the nature of the polymer expansion. This lemma forms a crucial part for the proofs of theorems 1 and 2.\nRemark 5: The last term in the right hand side of (11) contains the contributions of large polymers of size greater than λn (in a sea of small polymers). It turns out that this contribution cannot be expanded into an absolutely convergent series, and has to be treated non-perturbatively by counting methods.\nCorollary 1: Suppose r > 2. One can ﬁnd h 0 > 0 independent of n such that for |h| < h 0 ,\n1 n\nThe main difﬁculty in proving (15) is that the (optimal) estimate (34), (35) in the Appendix shows that K(γ) is not necessarily very small for graphs containing too many check nodes of maximal induced degree and too many variable nodes of even induced degree. More precisely for these bad graphs the activity is not exponentially small in the size of the graph. Then it is not possible to compensate for the \u201dentropy\u201d of the graph.\nWe will use an expander argument to show that these bad cases do not occur when |γ| < λn. We derive (15) with\nIn the process of this derivation one has to require 3 − l(1 − κ) > 0 and c > 0. This imposes the condition on the expansion constant κ > 1 − 2(r −1) lr . Note that an expansion constant cannot be greater than 1 − 1/l, so it is fortunate that we have 1 − 1 l > 1 − 2(r −1) lr (for any r > 2).\nNow we sketch the proof of (15) and (16). Recall that d i (γ) (resp. d a (γ)) is the induced degree of node i (resp. a) in γ. The type of γ is given by two vectors n = (n s (γ)) l s=2 and m = (m t (γ)) r t=2 deﬁned as n s (γ) := |{i ∈ γ ∩ V |d i (γ) = s }| and m t (γ) := |{a ∈ γ ∩ C|d a (γ) = t }|. In words, n s (γ) and m t (γ) count the number of variable and check nodes with induced degrees s and t in γ. Note that we have the constraints {\nWe apply the expander property to the set V = {i ∈ γ ∩ V }. This reads\n(l − s)n s (γ). With (18) this yields the constraint\nFinally, keeping only the product over t = 2, · · · , r − 1 in estimates (34) and (35) in the Appendix, we obtain (15).\nProof of Corollary 1: Conditional on Γ being an ex- pander we have from the previous proof 0 < Q << 1. Then,\npolymer expansion techniques [13] allow to estimate the sum over M in (12) term by term, which yields\n(21) If we take the expectation over graphs we cancel the sum over z ∈ V ∪ C and the n −1 . This allows to consider a sum of polymers rooted at one vertex. We compute this expectation by conditioning on the ﬁrst event that Γ is tree- like in a neighborhood of size O(ln n) around this vertex, and on the second complementary event. The second event has small probability O(n −(1−β) ) for any 0 < β < 1. Besides from (21) and (15) it is easy to show that n −1 | ln Z p | is bounded. For the ﬁrst event we have that the smallest polymer is a cycle with |γ| = O(ln n). This with (21) and (15) implies that n −1 | ln Z p (η, η) | ≤ n −β| ln |h|| . Combining all these remarks with the fact that Γ is an expander with probability 1 − O(n −(l(1−κ)−1) ) we obtain (13).\nIn this section we deal with the contribution R(η, η) cor- responding to terms containing at least one large polymer in (9). We have ∑\nThe next lemma shows that the contribution from large polymers is exponentially small, with high probability with respect to the graph ensemble.\nLemma 2: Fix δ > 0. Assume l ≥ 3 odd and l < r. There exists a constant C > 0 depending only on l and r such that for h small enough\nSketch of Proof: Let Ω Γ (n, m) be the set of all g ⊂ Γ with prescribed type (n(g), m(g)). By (35) and the Markov bound\n \nNotice that the probability in (25) is an upper bound on the probability in (24). In (25) we have\nThe expectation of the number of g ⊂ Γ with prescribed type can be estimated by combinatorial bounds provided by McKay [15]. It turns out that these subgraphs proliferate exponentially in n only for a subdomain of ∆ where K (n, m) is exponentially much smaller in n. In the subdomain where K (n, m) is not small (but it is always bounded) the number of subgraphs is subexponential when l is odd and l < r. As a consequence for l odd and l < r, we are able to prove that the sum on the right hand side of (25) is smaller than e −Cn . Unfortunately our estimates break down for l even.\nWe write 1\n(27) We ﬁrst look at the second contribution coming from large\npolymers. From corollary 1 and the Markov bound, we have for any ϵ > 0,\nUsing inequalities (24) and (28), and choosing δ = e −2nϵ it is not difﬁcult to show that (at this point one takes 2ϵ < C)\n(29) This allows to conclude that with probability 1 −\nIt is now easy to show theorem 1. There is a probability O(n −(l(1−κ)−1) ) that this last term is not small. However we can always show it is bounded by a constant independent of n. Indeed it is equal to the difference n −1 ln Z − f Bethe (η, η) − n −1 ln Z p (η, η) where each term separately can be shown to be bounded by a constant independent of n. Furthermore, corollary 1 tells us that the expectation of the absolute value of the ﬁrst term on the r.h.s is O(n −(l(1−κ)−1) ). Combining these remarks allows to conclude the proof of theorem 1.\nQuantities K a , K i are local and can be computed only with BP messages. Let m i = tanh(h i +\n1 − tanh 2 η i →a 1 −\n(33) Using these formulas and the BP equations we derive the following estimate for |h i | < h 0 small enough\n(35) Here 0 < α r < 1, α t > 1, β t > 1 are ﬁxed numerical constants (that we can take close to 1). Estimate (35) is essentially optimal for small h as can be checked by Taylor expanding K(g) in powers of h i .\nAcknowlegment. The work of M.V was supported by the Swiss National Science Foundation grant no 200021-121903."},"refs":[{"authors":[{"name":"P. O. Vontobe"}],"title":{"text":"Counting in graph covers: a combinatorial characteriza- tion of the Bethe entropy function, available at arXiv:1012"}},{"authors":[{"name":"E. B. Suddert"},{"name":"M. J. Wainwrigh"},{"name":"A. S. Willsk"}],"title":{"text":"Loop series and Bethe variational bounds in attractive graphical models, Proceedings of Neural Information Processing (2007)"}},{"authors":[{"name":"N. Ruozz"}],"title":{"text":"The Bethe Partition Function of Log-supermodular Graphical Models, arXiv:1202"}},{"authors":[{"name":"V. Chandrasekara"},{"name":"M. Chertko"},{"name":"D. Gamarni"},{"name":"D. Sha"},{"name":"J. Shi"},{"name":"J. Discrete Math 2"}],"title":{"text":"Counting Independent Sets Using the Bethe Approximation, SIAM  No"}},{"authors":[{"name":"M. M´ezar"},{"name":"A. Montanar"}],"title":{"text":"Information, Physics, and Computation, Ox- ford University Press (2009)"}},{"authors":[{"name":"A. Montanar"}],"title":{"text":"Tight bounds for LDPC and LDGM codes under MAP decoding, IEEE Trans"}},{"authors":[{"name":"N. Macri"}],"title":{"text":"Grifﬁth-Kelly-Sherman Correlation Inequalities: A Useful Tool in the Theory of Error Correcting Codes, IEEE Trans"}},{"authors":[{"name":"S. Kudeka"},{"name":"N. Macri"}],"title":{"text":"Sharp Bounds for Optimal Decoding of Low- Density Parity-Check Codes, IEEE Trans"}},{"authors":[{"name":"T. Richardso"},{"name":"R. Urbank"}],"title":{"text":"Modern Coding Theory, Cambridge Univer- sity Press, (2008)"}},{"authors":[{"name":"S. Korad"},{"name":"N. Macri"},{"name":"S. Kudeka"},{"name":"E. Int"}],"title":{"text":"Exact solution for the conditional entropy of Poissonian LDPC codes over the Binary erasure Channel, in Proc"}},{"authors":[{"name":"S. Kudeka"},{"name":"N. Macri"},{"name":"J. Discrete Math"}],"title":{"text":"Decay of Correlations for Sparse Graph Error Correcting Codes, SIAM  25(2) pp"}},{"authors":[{"name":"M. Chertko"},{"name":"V. Chernya"},{"name":"J. Stat"}],"title":{"text":"Loop series for discrete statistical models on graphs,  Mech"}},{"authors":[{"name":"D. Brydge"},{"name":"K. Osterwalde"},{"name":"R. Stora ed"}],"title":{"text":"A short course on cluster expansions, in   Les Houches, session XLIII, Part I, (1984)"}},{"authors":[{"name":"N. Macri"},{"name":"M. Vuffra"}],"title":{"text":"Polymer Expansions for Cycle LDPC Codes, Int"}},{"authors":[{"name":"D. McKa"}],"title":{"text":"B"}}]},"file":{"jsonClass":"File","file":"/home/arnfred/Code/trailhead/resources/isit2012/1569566855.pdf"},"links":[{"id":"1569565883","weight":6},{"id":"1569565867","weight":3},{"id":"1569565551","weight":6},{"id":"1569566943","weight":3},{"id":"1569565609","weight":3},{"id":"1569562685","weight":6},{"id":"1569566795","weight":3},{"id":"1569565897","weight":3},{"id":"1569564613","weight":6},{"id":"1569567009","weight":3},{"id":"1569566865","weight":6},{"id":"1569555999","weight":6},{"id":"1569565535","weight":3},{"id":"1569559805","weight":3},{"id":"1569565735","weight":20},{"id":"1569566445","weight":3},{"id":"1569566257","weight":3},{"id":"1569566661","weight":6},{"id":"1569566003","weight":3},{"id":"1569564339","weight":3},{"id":"1569566805","weight":6},{"id":"1569559199","weight":6},{"id":"1569566873","weight":3},{"id":"1569565093","weight":6},{"id":"1569566737","weight":6},{"id":"1569564291","weight":3},{"id":"1569566819","weight":6},{"id":"1569565529","weight":10},{"id":"1569566147","weight":3},{"id":"1569562367","weight":3},{"id":"1569565997","weight":10},{"id":"1569561397","weight":6},{"id":"1569565707","weight":3},{"id":"1569565139","weight":3},{"id":"1569566241","weight":3}],"meta":{"jsonClass":"HashMap$HashTrieMap","sessionid":"S13.T5.1","endtime":"15:00","authors":"Nicolas Macris, Marc Vuffray","date":"1341499200000","papertitle":"Beyond the Bethe Free Energy of LDPC Codes via Polymer Expansions","starttime":"14:40","session":"S13.T5: Analysis of LDPC Codes","room":"Kresge Little Theatre (035)","paperid":"1569566855"},"cluster":{"jsonClass":"Map$EmptyMap$"}}
