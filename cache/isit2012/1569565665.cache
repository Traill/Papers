{"id":"1569565665","paper":{"title":{"text":"Approximately Counting the Number of Constrained Arrays via the Sum-Product Algorithm"},"authors":[{"name":"Farzad Parvaresh"},{"name":"Pascal O. Vontobel"}],"abstr":{"text":"Abstract\u2014Very often, constrained coding schemes impose non- linear constraints on arrays and therefore it is usually nontrivial to determine how many arrays satisfy the given constraints. In this paper we show that there are non-trivial constrained coding scenarios where the number of constrained arrays can be estimated to a surprisingly high accuracy with the help of the sum-product algorithm, despite the fact that the underlying factor graphs have many short cycles, and we investigate the reasons why this is the case. These ﬁndings open up interesting possibilities for determining the number of constrained arrays also for scenarios where other counting and bounding techniques are not readily available."},"body":{"text":"An important ingredient of coded data communication and storage systems are constrained codes (see, e.g., [1] and references therein). The main idea is to transmit or to store only waveforms and patterns that will not be distorted too much by the channel (even without noise), or to use waveforms and patterns that are beneﬁcial for the operation of the device (like minimizing wear out, etc.). For example, it is rather suboptimal to transmit a wide-band waveform over a channel with a low-pass characteristic. The investigations in the present paper were motivated by families of constrained codes that naturally arise in the area of non-volatile memristor- based crossbar memory devices [2]\u2013[4], where such codes are employed towards limiting the half-select problem, the energy consumption, and the device and circuitry wear out.\nThe design of constrained codes encompasses the following steps: determining the desired constraints, determining the number of sequences or arrays that satisfy these constraints, and ﬁnally designing efﬁcient encoders and decoders (that often also include some error-correction control features). This paper focuses on the second step, i.e., determining the number of sequences or arrays that satisfy a given set of constraints. In his seminal paper, Shannon [5] considered the one-dimensional case and gave an explicit solution to a wide class of constrained coding setups. In particular, he gave a formula for determining the leading term of the number of constrained sequences as the block length goes to inﬁnity; however, the techniques can easily be extended to also obtain terms beyond the leading term.\nOne of the constrained coding problems that we consider in this paper is the following: counting the number of ele-\nρn − δ odd √ n ρn − δ even √ n\nn R ed u n d an cy [b it s]\nments in the set C n of n × n arrays over {0, 1} such that no row and no column contains more than n/2 ones. For n = 1, . . . , 15 the exact values of |C n | are shown in Fig. 1; actually, this ﬁgure does not show |C n |, but the redundancy r log 2 2 n 2 − log 2 |C n | = n 2 − log 2 |C n | w.r.t. the number of n × n arrays over {0, 1} where no constraints are imposed. Using results from [6], the papers [7], [8] determine the asymptotic enumeration of |C n | and obtain the redundancy expression\nHere, Φ( · ) denotes the cumulative distribution function of the normal distribution with zero mean and variance equal to one, i.e. , Φ(x) \t 1 √ 2π · x −∞ exp(−z 2 /2) dz, and x 0 denotes the constant x 0 \t arg max x Φ(x)e −x 2 /2 . Moreover, efﬁcient encoding and decoding of binary data into the set C n is presented in [9], [10], with an encoding redundancy of 2n.\nFinding the size of sets like C n can also be cast as the computation of the so-called total sum Z G (N) of a suitable graphical model N. 1 In some cases computing the total sum is tractable (see, e.g., [11] and references therein), but in general the exact computation of the total sum is intractable. However, there are methods available to approximate, or to upper and lower bound the total sum. In the present paper we consider the so-called Bethe approximation (BA) Z B (N) [12] to the total sum Z G (N). This approximation is interesting because of its connection [12] to the efﬁcient sum-product algorithm (SPA) [13], [14]. However, in general there are no guarantees on the quality of the BA/SPA approximation.\nFigure 1 also shows the resulting redundancy estimate r Bethe n 2 − log 2 (Z B (N)) that is obtained by applying the BA/SPA to a suitable normal factor graph whose underlying topology is the complete bipartite graph with two times n vertices. (The vertices correspond to the n row and n column constraints and the edges correspond to the n 2 entries of the array.) It is rather remarkable that this relatively simple approach gives such an accurate redundancy estimate for this scenario. After all, the underlying graph is, independently of n, highly connected and has many short cycles, i.e., the graph is of a type where the BA/SPA is not typically expected to perform well. In fact, for the present scenario one can show that the BA redundancy estimate matches the true redundancy in (1) at least up to and including the\nThere are several classes of factor graphs where the BA/SPA is known to work well (besides the case of cycle-free factor graphs, where the Bethe approximation is exact):\n\u2022 the underlying graph is sparse, and has no or very few short cycles, and a suitable correlation decay condition is satisﬁed (see, e.g., [15]);\n\u2022 Gaussian graphical models, where all function nodes are either Gaussian functions or subspace constraints (see, e.g. , [16]);\n\u2022 graphical models where valid conﬁgurations correspond to matchings [17] or perfect matchings [18]\u2013[21];\n\u2022 graphical models where the BA yields a provable lower bound to the total sum (see, e.g., [22], which relates Z B (N) to Z G (N) with the help of the loop calculus technique [23], or [24], which relates Z B (N) to Z G (N) with the help of (topological) graph covers [25]).\nIn general, however, the BA/SPA does not need to work well as is for example discussed in [26], where graphical models are presented that need a generalized version of the SPA (the so- called generalized belief propagation algorithm [12]) to yield reliable results (see also [27]).\nIn this paper, our goal is to study the reasons why the BA/SPA gives a very accurate estimate for the enumeration of sets like C n , despite the fact that the associated graphical model is highly connected and has many short cycles. Ulti- mately, we also want to apply the BA/SPA to counting prob-\nlems where it is difﬁcult to efﬁciently obtain good approxima- tions otherwise, but where one can show that the BA/SPA gives a good estimate. For example, in the case of the permanent of a non-negative matrix θ of size n × n (which can be cast as summing weighted perfect matchings, and which is known to be #P-complete), one can show that perm(θ) perm B (θ), where perm B (θ) is the BA of perm(θ); moreover, it is conjectured that perm(θ) χ n · perm B (θ), with χ n =\nin general and χ n = O( √ n) with high probability for some ensembles of matrices [21], [28].\nThe rest of this paper is structured as follows. Section II reviews some important notions in the context of normal factor graphs, Section III explores the reasons why Z B (N) is very close to Z G (N) for the graphical models under consideration, and Section IV offers some conclusions.\nNote that if we deﬁne C \u2032 n to be the set of all n × n arrays over {+1, −1} such that all row and all column sums (over the integers) are at least zero, then |C \u2032 n | = |C n |. This identity is clear from the bijection between C n and C \u2032 n that maps an array in C n to an array in C \u2032 n by applying component-wise the mapping 0 → +1, 1 → −1. Because of didactical reasons, in the rest of the paper we will prefer to consider binary arrays over {+1, −1} instead of binary arrays over {0, 1}.\nWe will use Iverson\u2019s notation, i.e., if S is a statement then [S] = 1 is S if true and [S] = 0 otherwise.\nThis section brieﬂy reviews some key facts about normal factor graphs (NFGs) [14], [29].\n· g f 3 (a e 3 , a e 4 , a e 7 ) · g f 4 (a e 5 , a e 6 , a e 8 ) · g f 5 (a e 7 , a e 8 ),\nwhere the so-called global function g is the product of the so-called local functions g f 1 , g f 2 , g f 3 , g f 4 , and g f 5 . The decomposition of this global function as a product of local functions can be depicted with the help of an NFG as shown in Fig. 2. In particular, the NFG in Fig. 2 consists of\n\u2022 the half edges e 1 and e 4 (sometimes also called \u201cexternal edges\u201d), with associated variables a e 1 and a e 4 (\u201cexternal variables\u201d).\n\u2022 the full edges e 2 , e 3 , e 5 , e 6 , e 7 , and e 8 (sometimes also called \u201cinternal edges\u201d), with associated variables a e 2 , a e 3 , a e 5 , a e 6 , a e 7 , and a e 8 (\u201cinternal variables\u201d).\n\u2022 a function node f ∈ F represents the local function g f (here with co-domain R 0 );\n\u2022 the set of half edges is denoted by E half ; \u2022 the set of full edges is denoted by E full ;\n\u2022 with an edge e ∈ E we associate the variable A e with alphabet A e and realization a e ;\n\u2022 an edge e is incident on a function node f if and only if a e appears as an argument of the local function g f ;\n\u2022 an element a ∈ A is called a conﬁguration; if g(a) = 0 then a is called a valid conﬁguration.\nThe total sum Z G (N) can be expressed in terms of the so- called Gibbs free energy function F G,N . Namely, Z G (N) = exp − min p F G,N (p) , where the minimization is over all probability mass functions over A (see, e.g., [12]).\nThe Bethe approximation (BA) of the Gibbs free energy function F G,N is called F B,N and the BA of the total sum Z G (N) is deﬁned to be Z B (N) exp − min β F B (β) , where the minimization is over all vectors in the local marginal polytope of N. For more details on these functions we refer to, e.g., [12]; for a discussion of these functions in the context of NFGs we refer to, e.g., [25]. The BA is interesting because the sum-product algorithm (SPA) [13], [14] can be used to efﬁciently ﬁnd the minimum of F B (or at least a stationary point of F B ), cf. [12].\nThe purpose of this section is to study a certain NFG N b,n with binary variables, whose total sum Z G (N b,n ) is related to the size of some constrained code C n with parameter n. We want to understand why the BA Z B (N b,n ) is rather close to the true value. To that end, it will be helpful to also study an NFG N g,n with the same topology but with different function nodes. Its total sum is denoted by Z G (N g,n ), whereas its BA is denoted by Z B (N g,n ). 2 These total sums and their BAs are summarized in Table I.\ntotal sum \t Z G (N b,n ) Z G (N g,n ) BA of total sum Z B (N b,n ) Z B (N g,n )\nThis section is structured as follows. First we introduce the NFGs N b,n and N g,n and afterwards we discuss various connections between N b,n and N g,n that explain why the total sums and their approximations in Table I are very close to each other. (For simplicity, in the present discussion we only keep track of the leading terms.) Throughout this section we will see the importance of the constants x 0 and ρ that also played a key role for the setup considered in Section I.\nIn the rest of this section, n will denote an arbitrary positive integer, and i and j will be elements of the set {1, . . . , n}. We warn the reader that variables and function nodes in upcoming drawings of NFGs can have different meanings depending on the context. Moreover, a local function in one NFG does not necessarily represent the same local function in another NFG, also if they have the same name.\nConsider the set M of all symmetric n × n arrays with entries in {+1, −1} and zeros in the diagonal; clearly |M| = 2 n(n −1)/2 . We are interested in the size of the constrained code C n given by all arrays C = (c i,j ) i,j ∈ M whose row and columns sums (over the integers) are at least zero. (Because of the symmetry of the arrays, it is clear that enforcing only the row constraints is sufﬁcient.)\nConsider now the NFG N b,n , which is speciﬁed as follows, see Fig. 3(a): the variable alphabets are A i,j \t {+1, −1} and the local functions g i,j are deﬁned to be g i,j (a i,j , a j,i )\n1/2 · [a i,j = a j,i ]. Because for every valid conﬁguration of N b,n we have a i,j = a j,i , we will in the following identify a i,j and a j,i . Finally, the local functions g i are deﬁned to be g i (a i ) \t j: j=i a i,j 0 . Clearly, there is a bijection between the set C n and the set of valid conﬁgurations of N b,n , and it can be veriﬁed that the |C n |/|M| = Z G (N b,n ). 3\nConsider the n · (n − 1)/2 i.i.d. random variables (U i,j ) i<j , where U i,j has normal distribution with mean 0 and variance σ 2 . For i = j we deﬁne U i,j \t 0 and for i > j we deﬁne U i,j U j,i . Moreover, let R i \t j U i,j . This set of random variables was studied by McEliece and Posner [30],\nwho showed that 2 n · Pr(R 1 0, . . . , R n 0) represents the expected number of stable points of a certain inﬁnite-range spin-glass memory with n spins [30].\nConsider now the NFG N g,n , whose topology is also given by Fig. 3(a) and which is speciﬁed as follows: the variable alphabets are A i,j R and the local functions g i,j are deﬁned to be g i,j (a i,j , a j,i ) (1/\nBecause for every valid conﬁguration of N g,n we have a i,j = a j,i , we will in the following identify a i,j and a j,i . Finally, the local functions g i are deﬁned to be g i (a i ) \t j: j=i a i,j 0 . One can verify that Pr(R 1 0, . . . , R n 0) = Z G (N g,n ).\nPr(V 0 + V 1 0, . . . , V 0 + V n 0 | V 0 = v 0 ) · p(v 0 ) dv 0 = Pr(R 1 0, . . . , R n 0) is dominated by the contribution of v 0 very close to σ · x 0 / √ n − 2, where x 0 has the same value as x 0 in Section I. With this key role played by x 0 , it is not surprising that ρ appears in the leading terms of Z G (N g,n ).\nNote that the total sum of N g,n can be written as the following integral\n(R 1 , . . . , R n ). We now want to argue why Z G (N b,n ) is close to Z G (N g,n ). Namely, using the results of [31]\u2013[33], along with techniques analogous to techniques used in [7], [8], the total sum Z G (N b,n ) can be written as the sum of two terms. The ﬁrst term is a discrete version of the above integral for vectors r that give the dominant contribution to the integral. In the limit n → ∞ the approximation of the integral by the discrete version becomes better and better. The second term can be bounded by simple lower and upper bounds whose values are negligible compared to the ﬁrst term.\nIn this section we discuss the closeness of Z B (N b,n ) to Z B (N g,n ). For obtaining Z B (N b,n ), we must ﬁnd the relevant ﬁxed point of the SPA and evaluate the Bethe free energy F B,N b,n at this ﬁxed point; a similar statement holds for Z B (N g,n ).\nFor ﬁnite n, this can be done numerically, as was done for obtaining the BA redundancy values in Fig. 1 for the counting problem that is discussed in Section I. (This computation is vastly simpliﬁed by using the inherent symmetries of the relevant NFG.)\nFor large n we can show analytically why Z B (N b,n ) is very close to Z B (N g,n ). (As mentioned at the beginning of Section III, here we only show how to obtain the leading order terms.) Towards doing this, let us ﬁrst investigate the NFG N b,n . Consider the SPA ﬁxed-point messages {µ i,j (a i,j )} i,j and {µ \u2032 i,j (a i,j } i,j as shown in Fig. 3(a). By symmetry we can assume that there are functions µ, µ \u2032 : {+1, −1} → R 0 such that µ i,j (a) = µ(a) and µ \u2032 i,j (a) = µ \u2032 (a). (We omit the details showing that the relevant SPA ﬁxed point satisﬁes this symmetry.) Then µ \u2032 (a) must be related to µ(a) by the SPA ﬁxed-point equations\nsome γ n , and so the above ﬁxed-point equations can, in the limit n → ∞, be approximated by\nn − 2 , where Φ was introduced in Section I. Finally, it can be shown that γ n → x 0 , where x 0 was deﬁned in Section I.\nLet us now investigate the SPA ﬁxed-point equations for N g,n . Without going into the details, by symmetry we can assume that there are functions µ, µ \u2032 : R → R 0 such that µ i,j (a) = µ(a) and µ \u2032 i,j (a) = µ \u2032 (a), and so\n\u2032 (¯ γ n ) Φ(¯ γ n )\nn − 2 , One can show that in the limit n → ∞ this ansatz for µ for obtaining the leading term is justiﬁed and one gets ¯ γ n → x 0 .\nGiven the appearance of x 0 in both cases, it is not surprising to ﬁnd, after doing the relevant computations, that the leading terms of Z B (N b,n ) and Z B (N g,n ) will be expressed in terms of the constant ρ, and are actually the same.\nIn order to establish the closeness of Z G (N g,n ) to Z B (N b,n ) and Z B (N g,n ) we use (topological) graph covers. Graph covers were used in [25] to give a combinatorial characterization of the BA of the total sum of a graphical model. Applying these results to N b,n , one obtains\nwhere the term in angular brackets represents the average of the total sum of N, where the average is taken over all M -fold covers of N b,n . Without going into the details, the constants x 0 and ρ play again a key role in evaluating the right-hand side of the above expression, ultimately showing the closeness of Z B (N b,n ) to Z G (N g,n ). Similar investigations can be made w.r.t. Z B (N g,n ).\nIn this paper we have presented some classes of NFGs for which the Bethe approximation to the total sum works surprisingly well, and for a particular binary graphical model we have analyzed in more detail the reasons for this behavior. Interestingly, an associated graphical model with Gaussian local functions played a key role in this analysis.\nNote that similar techniques can be used to analyze the BA of the graphical model that is discussed in Section I. Although there does not appear to be a trick similar to the one that was used in Section III-C to analyze the total sum of the associated graphical model with Gaussian local functions, more elaborate techniques can be used to handle the total sum of that graphical model.\nWe gratefully acknowledge our colleague Ronny Roth for providing us the exact redundancy values shown in Fig. 1."},"refs":[{"authors":[{"name":"K. A. S. Immink"},{"name":"P. H. Siegel"},{"name":"J. K. Wolf"}],"title":{"text":"Codes for digital recorders"}},{"authors":[{"name":"P. O. Vontobel"},{"name":"W. Robinett"},{"name":"P. J. Kuekes"},{"name":"D. R. Stewart"},{"name":"J. Straznicky"},{"name":"R. S. Williams"}],"title":{"text":"Writing to and reading from a nano-scale crossbar memory based on memristors"}},{"authors":[{"name":"E. Ordentlich"},{"name":"G. Ribeiro"},{"name":"R. M. Roth"},{"name":"G. Seroussi"},{"name":"P. O. Vontobel"}],"title":{"text":"Coding for limiting current in memristor crossbar memories"}},{"authors":[{"name":"D. B. Strukov"},{"name":"R. S. Williams"}],"title":{"text":"Four-dimensional address topology for circuits with stacked multilayer crossbar arrays"}},{"authors":[{"name":"C. E. Shannon"}],"title":{"text":"A mathematical theory of communication"}},{"authors":[{"name":"E. R. Canﬁeld"},{"name":"C. Greenhill"},{"name":"B. D. McKay"}],"title":{"text":"Asymptotic enumeration of dense 0\u20131 matrices with speciﬁed line sums"}},{"authors":[{"name":"E. Ordentlich"},{"name":"F. Parvaresh"},{"name":"R. Roth"}],"title":{"text":"Asymptotic enumeration of binary matrices with bounded row and column weights"}},{"authors":[],"title":{"text":"Asymptotic enumeration of binary matrices with bounded row and column weights"}},{"authors":[{"name":"E. Ordentlich"},{"name":"R. M. Roth"}],"title":{"text":"Low complexity two-dimensional weight-constrained codes"}},{"authors":[],"title":{"text":"Low complexity two-dimensional weight-constrained codes"}},{"authors":[{"name":"V. Y. Chernyak"},{"name":"M. Chertkov"}],"title":{"text":"Planar graphical models which are easy"}},{"authors":[{"name":"J. S. Yedidia"},{"name":"W. T. Freeman"},{"name":"Y. Weiss"}],"title":{"text":"Constructing free-energy approximations and generalized belief propagation algorithms"}},{"authors":[{"name":"F. R. Kschischang"},{"name":"B. J. Frey"},{"name":"H.-A. Loeliger"}],"title":{"text":"Factor graphs and the sum-product algorithm"}},{"authors":[{"name":"H.-A. Loeliger"}],"title":{"text":"An introduction to factor graphs"}},{"authors":[{"name":"V. Chandrasekaran"},{"name":"M. Chertkov"},{"name":"D. Gamarnik"},{"name":"D. Shah"},{"name":"J. Shin"}],"title":{"text":"Counting independent sets using the Bethe approximation"}},{"authors":[{"name":"Y. Weiss"},{"name":"W. T. Freeman"}],"title":{"text":"Correctness of belief propagation in Gaussian graphical models of arbitrary topology"}},{"authors":[{"name":"M. Bayati"},{"name":"C. Nair"}],"title":{"text":"A rigorous proof of the cavity method for counting matchings"}},{"authors":[{"name":"M. Chertkov"},{"name":"L. Kroc"},{"name":"M. Vergassola"}],"title":{"text":"Belief propagation and beyond for particle tracking"}},{"authors":[{"name":"B. Huang"},{"name":"T. Jebara"}],"title":{"text":"Approximating the permanent with belief prop- agation"}},{"authors":[{"name":"M. Chertkov"},{"name":"L. Kroc"},{"name":"F. Krzakala"},{"name":"M. Vergassola"},{"name":"L. Zdeborov´a"}],"title":{"text":"Inference in particle tracking experiments by passing messsages be- tween images"}},{"authors":[{"name":"P. O. Vontobel"}],"title":{"text":"The Bethe permanent of a non-negative ma- trix"}},{"authors":[{"name":"E. B. Sudderth"},{"name":"M. J. Wainwright"},{"name":"A. S. Willsky"}],"title":{"text":"Loop series and Bethe variational bounds in attractive graphical models"}},{"authors":[{"name":"M. Chertkov"},{"name":"V. Y. Chernyak"}],"title":{"text":"Loop series for discrete statistical models on graphs"}},{"authors":[{"name":"N. Ruozzi"}],"title":{"text":"The Bethe partition function of log-supermodular graphical models"}},{"authors":[{"name":"P. O. Vontobel"}],"title":{"text":"Counting in graph covers: a combinatorial characteriza- tion of the Bethe entropy function"}},{"authors":[{"name":"O. Shental"},{"name":"N. Shental"},{"name":"S. Shamai (Shitz)"},{"name":"I. Kanter"},{"name":"A. J. Weiss"},{"name":"Y. Weiss"}],"title":{"text":"Discrete-input two-dimensional Gaussian channels with memory: estimation and information rates via graphical models and statistical mechanics"}},{"authors":[{"name":"G. Sabato"},{"name":"M. Molkaraie"}],"title":{"text":"Generalized belief propagation for the noiseless capacity and information rates of run-length limited con- straints"}},{"authors":[{"name":"L. Gurvits"}],"title":{"text":"Unleashing the power of Schrijver\u2019s permanental inequality with the help of the Bethe approximation"}},{"authors":[{"name":"G. D. Forney"}],"title":{"text":"Codes on graphs: normal realizations"}},{"authors":[{"name":"E. C. Posner"},{"name":"R. J. McEliece"}],"title":{"text":"The number of stable points of an inﬁnite-range spin glass memory"}},{"authors":[{"name":"B. D. McKay"},{"name":"N. C. Wormald"}],"title":{"text":"Asymptotic enumeration by degree sequence of graphs of high degree"}},{"authors":[{"name":"O. Riordan"},{"name":"A. Selby"}],"title":{"text":"The maximum degree of a random graph"}},{"authors":[{"name":"B. D. McKay"},{"name":"I. M. Wanless"},{"name":"N. C. Wormald"}],"title":{"text":"Asymptotic enumer- ation of graphs with a given bound on the maximum degree"}}]},"file":{"jsonClass":"File","file":"/home/arnfred/Code/trailhead/resources/isit2012/1569565665.pdf"},"links":[],"meta":{"jsonClass":"HashMap$HashTrieMap","sessionid":"S2.T6.2","endtime":"12:10","authors":"Farzad Parvaresh, Pascal Vontobel","date":"1341229800000","papertitle":"Approximately Counting the Number of Constrained Arrays via the Sum-Product Algorithm","starttime":"11:50","session":"S2.T6: Constrained Coding","room":"Kresge Rehearsal A (033)","paperid":"1569565665"},"cluster":{"jsonClass":"Map$EmptyMap$"}}
